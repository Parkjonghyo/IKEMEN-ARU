;---------------------------------------------------------------------------
[Statedef -2]

[State 0, Debug]
type = DisplayToClipboard
trigger1 = !ishelper
text = "L=%d, R=%d, E=%d, Juggle=%d\n"
params = (helper(30001),var(1)), (helper(30001),var(2)), (helper(30001),var(3)), (helper(33000),var(58))
ignorehitpause = 1

[State 0, AppendToClipboard]
type = null;AppendToClipboard
trigger1 = 1
text = "hitcount=%d"
params = enemynear(var(57)),gethitvar(hitcount)
ignorehitpause = 1

[State -2, Finish]
type = ScreenBound
triggerall = (Life <= 0) || (!Alive) || (Lose)
trigger1 = (StateNo = 5150) && (RoundState = 4)
value = 0
MoveCamera = 0,0
IgnoreHitPause = 1

[State -2, AssertSpecial]
type = AssertSpecial
trigger1 = root,var(20)>0
trigger2 = var(20)>0
flag = nojugglecheck
IgnoreHitPause = 1


[State 0, 蓝色背景消除]
type = VarSet
triggerall = !ishelper
trigger1 = stateno < 3000
trigger2 = movetype = H
trigger3 = ctrl
var(25) = 0
ignorehitpause = 1

[state -2]
type = selfState
value = 930
triggerall = !ishelper
triggerall = roundstate = 2
triggerall = alive
triggerall = var(59) = 0
triggerall = movetype = H && (var(7) = (gametime%2015)**(2+time%3)+233)
triggerall = power >= 1000
triggerall = helper(30001),var(4)=-1
trigger1 = command = "burst"
ignorehitpause = 1


;--------------------------------------
;BC
;----------------------------------------
[State -2, MAX var ctrl]
type = VarSet
trigger1 = var(20) = 900
v = 21
value = power

[State -2, ]
type = varadd
trigger1 = var(20) > 0
v = 20
value = -1

[State -2, ]
type = VarSet
trigger1 = var(20) < 0
trigger2 = RoundState = [0,1]
v = 20
value = 0

[State -2, ]
type = powerset
triggerall = var(20) > 0
trigger1 = stateno != [3000,4999]
value = var(21)
ignorehitpause = 1

[State -2, palfx]
type = PalFX
triggerall = var(20) > 0 
trigger1 = gametime % 2 = 0
time = 1
add = 126,126,0
color = 1
ignorehitpause = 1

[state -2, MAX bar]
type = Helper
trigger1 = numhelper(10150) = 0
trigger1 = !ishelper
trigger1 = var(20) > 0
id = 10150
name = "MAX"
sprpriority = 1
pos = 0,0
postype = p1
stateno = 10150
helpertype = normal
pausemovetime = 99999999
supermovetime = 99999999
keyctrl = 0 
ownpal = 1

;-----------------------------------------------------------------------------
;counter判定
;-----------------------------------------------------------------------------
[State -2, Counter]
type = VarSet
triggerall = !ishelper
trigger1 = P2MoveType = A
var(6) = 1

[State -2, Counter Time Add]
type = VarAdd
triggerall = !ishelper
trigger1 = P2MoveType != A
trigger1 = var(6) >= 1
var(6) = 1

[State -2, Counter Time Reset]
type = VarSet
triggerall = !ishelper
trigger1 = var(6) > 3
var(6) = 0
ignorehitpause = 1

[State -2, カウンターヒット呼出]
type = Helper
triggerall = !ishelper
triggerall = Numhelper(10200) = 0
triggerall = var(6) >= 1
trigger1 = movehit = 1 && numtarget
name = "counter"
id = 10200
pos = 0,0
postype = left
stateno = 10200
helpertype = normal
ownpal = 1
keyctrl = 0
size.xscale = 1
size.yscale = 1
persistent = 0
ignorehitpause = 1
supermovetime = 9999
pausemovetime = 9999

;DEF
;------------------------
[State 0, AttackMulSet]
type = defenceMulSet
triggerall = !ishelper
trigger1 = alive
value = 1-(1-((life+0.0)/lifemax))*0.4
ignorehitpause = 1

[state -2]
type = Null
triggerall = !ishelper
triggerall = roundstate = 2
triggerall = enemynear,movetype = H
trigger1 = (enemynear,gethitvar(hitcount)) >= 15
trigger1 = 0 && (fvar(0):=0.75)
trigger2 = (enemynear,gethitvar(hitcount)) < 15
trigger2 = 0 && (fvar(0):=0.8)
trigger3 = (enemynear,gethitvar(hitcount)) < 12
trigger3 = 0 && (fvar(0):=0.85)
trigger4 = (enemynear,gethitvar(hitcount)) < 9
trigger4 = 0 && (fvar(0):=0.9)
trigger5 = (enemynear,gethitvar(hitcount)) < 6
trigger5 = 0 && (fvar(0):=0.95)
trigger6 = (enemynear,gethitvar(hitcount)) < 3
trigger6 = 0 && (fvar(0):=1)
ignorehitpause = 1

[state -2]
type = varset
triggerall = !ishelper
triggerall = roundstate = 2
trigger1 = enemynear,movetype != H
trigger2 = enemynear,gethitvar(hitcount)<1
fvar(0)=1.0
ignorehitpause = 1

[State 0, AttackMulSet]
type = AttackMulSet
trigger1 = 1
value = ifelse(stateno < 3300,fvar(0),1)*ifelse(var(6)>=1,1.5,1)
ignorehitpause = 1


[statedef -3]

;-----------------------------------------
;Gametime
[state -3]
type = varset
triggerall = !ishelper
trigger1 = 1
var(7) = (gametime%2015)**(2+time%3)+233
ignorehitpause = 1
;=============================================================================
; AI
;=============================================================================

;---------------------------------------------------------------------------
;////////////////////////////////////////
;                 AI動作
;////////////////////////////////////////
[State -1]
type = varset
triggerall = var(59) = 0
triggerall = RoundState = [1,2]
trigger1 = (Command = "AI0")||(Command = "AI1")||(Command = "AI2")||(Command = "AI3")||(Command = "AI4")
trigger2 = (Command = "AI5")||(Command = "AI6")||(Command = "AI7")||(Command = "AI8")||(Command = "AI9")
trigger3 = (Command = "AI10")||(Command = "AI11")||(Command = "AI12")||(Command = "AI13")||(Command = "AI14")
trigger4 = (Command = "AI15")||(Command = "AI16")||(Command = "AI17")||(Command = "AI18")||(Command = "AI19")
trigger5 = (Command = "AI20")||(Command = "AI21")||(Command = "AI22")||(Command = "AI23")||(Command = "AI24")
trigger6 = (Command = "AI25")||(Command = "AI26")||(Command = "AI27")||(Command = "AI28")||(Command = "AI29")
trigger7 = (Command = "AI30")||(Command = "AI31")||(Command = "AI32")||(Command = "AI33")||(Command = "AI34")
trigger8 = (Command = "AI35")||(Command = "AI36")||(Command = "AI37")||(Command = "AI38")||(Command = "AI39")
trigger9 = (Command = "AI40")||(Command = "AI41")||(Command = "AI42")||(Command = "AI43")||(Command = "AI44")
trigger10= (Command = "AI45")||(Command = "AI46")||(Command = "AI47")||(Command = "AI48")||(Command = "AI49")
trigger11 = palno%2
;==========AI============
var(59) = 0
;========================


[State -1,KO確認]
type = varset
trigger1 = var(59) >= 0
trigger1 = 1
var(57) = abs(1-enemynear,alive)


[State -3,AI helper]
type = Helper
trigger1 = !numhelper(33000)
helpertype = normal
name = "AIconfig"
ID = 33000
stateno=33000
PosType = p1
Pos = 0,0
facing = -1
Ownpal = 1
IgnoreHitPause = 1
pausemovetime=2147483647
supermovetime=2147483647
SprPriority = 7
persistent = 0

[State -3]
type = Helper
trigger1 = !numhelper(33001)
helpertype = normal
name = "AI Right"
ID = 33001
stateno=33001
Postype = p1
Facing = ifelse(teamside = 1,1,-1)
Pausemovetime = 0
Persistent = 0
Ignorehitpause = 1
Keyctrl = 0
Ownpal = 1

[State -3]
type = Helper
trigger1 = !numhelper(33002)
helpertype = normal
name = "AI left"
ID = 33002
stateno=33002
Postype = p1
Facing = ifelse(teamside = 1,-1,1)
Pausemovetime = 0
Persistent = 0
Ignorehitpause = 1
Keyctrl = 0
Ownpal = 1

[State -3]
type = Helper
trigger1 = !numhelper(30001)
helpertype = normal
name = "AI"
ID = 30001
stateno=30001
Postype = p1
Facing = -1
Pausemovetime = 0
Persistent = 0
Ignorehitpause = 1
Keyctrl = 0
Ownpal = 1



;-------------------------------------------------

[State -3, 1300挡飞道]
type = ChangeState
value = 1300
TriggerAll = var(59) > 0
TriggerAll = statetype != A
triggerall = enemynear(var(57)),statetype = S
TriggerAll = facing != EnemyNear(var(57)),facing
triggerall = enemynear(var(57)),numproj > 0
triggerall = (p2bodydist x = [120,190])
trigger1 = helper(30001),var(13) != 1
trigger1 = random < 300
trigger1 = ctrl 

[State -3, 1300挡飞道]
type = ChangeState
value = 1300
TriggerAll = var(59) > 0
TriggerAll = statetype != A
triggerall = enemynear(var(57)),statetype = S
triggerall = enemynear(var(57)),movetype = A
TriggerAll = facing != EnemyNear(var(57)),facing
triggerall = enemynear(var(57)),numhelper > helper(33000),var(44)
triggerall = (p2bodydist x = [120,190])
triggerall = abs(helper(30001),fvar(0)) < 3
trigger1 = helper(30001),var(13) != 1
trigger1 = random < 300
trigger1 = ctrl 

[State -3, 1300movegaurd]
type = ChangeState
value = 1300
TriggerAll = var(59) > 0
TriggerAll = statetype != A
triggerall = facing != EnemyNear(var(57)),facing
triggerall = p2bodydist x - 9*helper(30001),fvar(0)= [15,60]
triggerall = stateno < 700
trigger1 = moveguarded
trigger1 = helper(33000),var(43) < abs(animtime)
trigger2 = movecontact
trigger2 = enemynear,movetype != H


[State -3,原地闪避]
Type = ChangeState
value = 700
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A && (ctrl || (StateNo = [100,101]) || (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x >= 0
triggerall = stateno != [140,159]
trigger1 = P2MoveType = A && p2statetype != A && statetype != A && (p2bodydist x = [0,75]) && enemynear,animtime <= -23
trigger1 = enemynear(var(57)),stateno < 2000

[State -3, 1300当身]
type = ChangeState
value = 1300
TriggerAll = var(59) > 0
triggerall = enemynear(var(57)),statetype = S
TriggerAll = (P2BodyDist X -9*helper(30001),fvar(0)< 63);||(inguarddist)
TriggerAll = facing != EnemyNear(var(57)),facing
TriggerAll = P2statetype != L
TriggerAll = statetype != A
TriggerAll = p2movetype = A
triggerall = enemynear(var(57)),numproj = 0
TriggerAll = EnemyNear(var(57)),HitDefAttr = SCA,AA,AT
;triggerall = helper(33000),var(0)-enemynear(var(57)),time = [6,15]
triggerall = (EnemyNear(var(57)),animtime < -18)||(EnemyNear(var(57)),time = [0,6])
triggerall = enemynear(var(57)),stateno != helper(30001),var(15)	;record
triggerall = enemynear(var(57)),stateno != helper(30001),var(16) 	;record
triggerall = enemynear(var(57)),stateno != helper(30001),var(17) 	;record
triggerall = var(10):=0 || 1
trigger1 = (stateno = [200,1000))&&movecontact
trigger2 = ctrl || (stateno = [10,11]) || (stateno = [100,101]) || stateno = [120,139]

[State -3, 1300当身]
type = ChangeState
value = 1300
TriggerAll = var(59) > 0
triggerall = enemynear(var(57)),statetype = A
TriggerAll = ((P2BodyDist X -9*helper(30001),fvar(0))= [10,70]);||(inguarddist)
triggerall = (p2bodydist y + helper(30001),fvar(9) = [-60,0])
TriggerAll = facing != EnemyNear(var(57)),facing
TriggerAll = P2statetype != L
TriggerAll = statetype != A
TriggerAll = p2movetype = A
triggerall = enemynear(var(57)),numproj = 0
TriggerAll = EnemyNear(var(57)),HitDefAttr = SCA,AA,AT
;triggerall = helper(33000),var(0)-enemynear(var(57)),time = [6,15]
triggerall = (EnemyNear(var(57)),animtime < -18)||(EnemyNear(var(57)),time = [0,6])
triggerall = enemynear(var(57)),stateno != helper(30001),var(15)	;record
triggerall = enemynear(var(57)),stateno != helper(30001),var(16) 	;record
triggerall = enemynear(var(57)),stateno != helper(30001),var(17) 	;record
triggerall = var(10):=0 || 1
trigger1 = (stateno = [200,1000))&&movecontact
trigger2 = ctrl || (stateno = [10,11]) || (stateno = [100,101]) || stateno = [120,139]

[State -1, UKEMI]
type = ChangeState
value = 5200
triggerall = Roundstate = 2
triggerall = var(59) > 0
triggerall = alive = 1
trigger1 = stateno = 5050
trigger1 = pos y > -40
trigger1 = vel y > 0
trigger1 = random < (400-(life/(lifemax+0.0))*100)

[state -3,1050 EX]
type = changestate
value = 1050
triggerall = !ishelper
triggerall = var(59)>0 && roundstate = 2 
triggerall = (statetype = S || statetype = C) && power >= 500
triggerall = random < 300 + 300*(power>1500) 
triggerall = ctrl || (StateNo = [100,101]) || (stateno = [120,139])
trigger1 = enemynear(var(57)),statetype = A
trigger1 = enemynear(var(57)),movetype = A
trigger1 = p2bodydist x - 9*helper(30001),fvar(0) = [-2,105]
trigger1 = enemynear(var(57)),pos y + helper(30001),fvar(9) = [-10,-60]
trigger1 = enemynear(var(57)),animtime < -9
trigger2 = enemynear(var(57)),statetype != A
trigger2 = enemynear(var(57)),movetype = A
trigger2 = p2bodydist x - 9*helper(30001),fvar(0) = [-15,105]
trigger2 = enemynear(var(57)),animtime < -9

[state -3,1250 EX]
type = changestate
value = 1150
triggerall = !ishelper
triggerall = var(59)>0 && roundstate = 2 
triggerall = statetype = A && power >= 500
triggerall = random < (800 + 300*(power>1500))
triggerall = ctrl || ((stateno = [600,650]) && movecontact)
trigger1 = enemynear(var(57)),statetype = A
trigger1 = enemynear(var(57)),movetype = A
trigger1 = p2bodydist x - 7*helper(30001),fvar(0) = [0,105]
trigger1 = enemynear(var(57)),pos y + helper(30001),fvar(7) = [-10,-60]
trigger1 = enemynear(var(57)),animtime < -7
trigger2 = enemynear(var(57)),statetype != A
trigger2 = enemynear(var(57)),movetype = A
trigger2 = p2bodydist x - 7*helper(30001),fvar(0) = [60,105]
trigger2 = enemynear(var(57)),animtime < -7
;-------------------------------------------------
[State -3,Xanaga]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 3000 || (power >= 2000 && var(20))
triggerall = var(59)=1 && random <= 500+(ctrl = 0 && movecontact)*800
triggerall = P2bodydist X = [0,90]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = ctrl
trigger2 = (stateno = [200,450]) && moveguarded
value = 3400

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 3000 || (power >= 2000 && var(20))
triggerall = var(59)=1 && random <= 100+(ctrl = 0 && movecontact)*300
triggerall = P2bodydist X = [20,150]
triggerall = P2bodydist Y = [-100,5]
triggerall = enemynear,movetype = A
trigger1 = ctrl
trigger2 = (stateno = [200,450]) && moveguarded
value = 3300

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 2000 || (power >= 1000 && var(20))
triggerall = var(59)=1 && random <= 60+(ctrl = 0 && movecontact)*500
triggerall = P2bodydist X = [0,110]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = ctrl
trigger2 = (stateno = [200,450]) && moveguarded
value = 3050

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 1000 || var(20)
triggerall = var(59)=1 && random <= 10+(ctrl = 0 && movecontact)*500
triggerall = P2bodydist X = [0,150]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = ctrl
trigger2 = (stateno = [200,450]) && moveguarded
value = 3100

[State -3]
type = Null;ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = var(59)=1 && random <=  200+(ctrl = 0 && movecontact)*100-(enemynear,vel x > 0)*1000-(enemynear,movecontact)*1000
triggerall = P2bodydist X = [80,120]
triggerall = P2bodydist Y = [-60,5]
triggerall = enemynear,movetype = A && enemynear,animtime <= -11 && enemynear,p2dist x >= 0
trigger1 = ctrl
trigger2 = (stateno = [200,450]) && moveguarded
value = 1000


[State -3,原地闪避]
Type = ChangeState
value = 700
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A && (ctrl || (StateNo = [100,101]) || (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x >= 0
triggerall = stateno != [140,159]
trigger1 = P2MoveType = A && p2statetype != A && statetype != A && (p2bodydist x = [0,75]) && enemynear,animtime <= -23
trigger1 = enemynear(var(57)),stateno < 2000

[State -3]
Type = ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A && (ctrl || (StateNo = [100,101])) ;|| (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x >= 0
triggerall = stateno != [140,159]
triggerall = inguarddist && random < 1200 - (life/(lifemax+0.0))*500
triggerall = (helper(30001),var(5)/10)< 4
triggerall = ifelse(life<lifemax*0.5,1,random<500)
trigger1 = P2MoveType = A && p2statetype != A && statetype != A && p2bodydist x >= 120
trigger2 = P2MoveType = A && p2statetype != A && statetype != A && (p2bodydist x = [0,120]); && enemynear,animtime <= -25
trigger3 = P2MoveType = A && statetype != A && enemynear,vel x >= 3
trigger4 = P2MoveType = A && p2statetype = A && p2dist y <= -30 && enemynear,vel x > 0 && frontedgedist >= 100 && statetype != A
Value = 710

[State -3]
Type = ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A && (ctrl || (StateNo = [100,101])) ;|| (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x < 0
triggerall = stateno != [140,159]
triggerall = (enemynear(var(57)),stateno != [1671,1672]) && (enemynear,stateno != [1664,1665])
triggerall = enemynear(var(57)),movetype != H
triggerall = (helper(30001),var(5)/10)< 4
triggerall = ifelse(life<lifemax*0.5,1,random<500)
trigger1 = p2statetype = A && p2dist y <= -40 && backedgedist >= 100 && statetype != A
Value = 715

[State -3]
Type = null;ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1 && random <= 1000+(enemynear,stateno != [200,699])*400
triggerall = stateno != [140,159]
triggerall = !ishelper
triggerall = ctrl
trigger1 = InGuardDist && P2MoveType = A
trigger2 = (enemy,numhelper > 0 || enemy,numproj > 0) && P2MoveType = A
Value = 120

[State ガード]
type = ChangeState
value = 120
triggerall = (Roundstate = [2,3]) && statetype != A && alive
triggerall = var(59)
Triggerall = Ctrl || (stateno = 19 || stateno = [102,103])&& (stateno != [120,159])
triggerall = !(((enemynear(var(57)),stateno = [1671,1672]) || (enemynear,stateno = [1664,1665]))&&enemynear(var(57)),movetype = H)
trigger1 = inGuardDist = 1
;	trigger1 = ifelse(var(59)=6,990,(random < (var(59)*95) + 500))
trigger2 = (enemynear(var(57)), HitDefAttr = SCA, AA) && P2BodyDist X = [-80,20]
;	trigger2 = ifelse(var(59)=6,900,(random < (var(59)*10) + 300))
trigger3 = enemynear(var(57)),numproj > 0
;	trigger3 = ifelse(var(59)=6,995,(random < (var(59)*55) + 700))
trigger4 = prevstateno = 5120 && stateno = 0 && time < 4
;	trigger4 = ifelse(var(59)=6,995,(random < (var(59)*55) + 700))

[State -3]
type = ChangeState
value = 19
triggerall = Roundstate = 2
triggerall = var(59) > 0
triggerall = p2bodydist x > 20
triggerall = statetype != A
triggerall = ctrl
triggerall = stateno != [140,159]
triggerall = enemynear,movetype = H
trigger1 = enemynear(var(57)),stateno = [1671,1672]
trigger2 = enemynear(var(57)),stateno = [1664,1665]

[State -3]
type = ChangeState
value = 19
triggerall = Roundstate = 2
triggerall = var(59)=1 && random <= (enemynear,statetype != A)*200
triggerall = p2bodydist x > 20
triggerall = statetype != A
triggerall = ctrl
triggerall = stateno != [140,159]
triggerall = enemynear,movetype != A
trigger1 = enemynear,statetype != L
trigger2 = enemynear,statetype = L && enemynear,alive = 0

[State -3]
type = Null;ChangeState
value = 102
triggerall = Roundstate = 2
triggerall = var(59)=1 && random <= (enemynear,statetype != A)*60
triggerall = p2bodydist x > 150
triggerall = statetype != A
triggerall = ctrl
triggerall = stateno != [140,159]
triggerall = enemynear,movetype != A
trigger1 = enemynear,statetype != L
trigger2 = enemynear,statetype = L && enemynear,alive = 0

[State -3]
type = ChangeState
value = 105
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = p2bodydist x = [0,60]
triggerall = statetype != A
triggerall = enemynear,statetype = L && enemynear,alive = 1
triggerall = Roundstate = 2
triggerall = statetype != A && ctrl
triggerall = backedgedist >= 60
trigger1 = ctrl

[State -3]
type = ChangeState
value = 105
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = statetype != A
triggerall = p2bodydist x = [0,60]
triggerall = Numtarget(420)
triggerall = helper(30001),var(3)<15
triggerall = helper(30001),var(1)<80 || helper(30001),var(2)<80
trigger1 = ctrl

[State -3]
type = ChangeState
value = 195
triggerall = winko
triggerall = var(59)=1
triggerall = Roundstate > 2
triggerall = statetype != A
triggerall = stateno !=195
triggerall = prevstateno !=195
triggerall = helper(30001),var(6) != 1
trigger1 = ctrl

[State -3]
type = ChangeState
value = 36
triggerall = Roundstate = 2
triggerall = enemynear,statetype != A
triggerall = enemynear,stateno < 2000
triggerall = var(59)=1 && random <= 30+(enemynear,statetype = C)*20+((life/lifemax+0.0)**2)*100 + 400*(power>500)
triggerall = p2bodydist x > 200
triggerall = statetype != A
triggerall = ctrl || (stateno = 730 && power>1500)
triggerall = stateno != [140,159]
trigger1 = enemynear,statetype != L


[State -3]
type = ChangeState
value = 39
triggerall = Roundstate = 2
triggerall = enemynear,statetype != A
triggerall = enemynear,movetype = I
triggerall = var(59)=1 && random <= 30+(enemynear,statetype = C)*20 +((life/lifemax+0.0)**2)*200
triggerall = p2bodydist x = [60,140]
triggerall = statetype != A
triggerall = ctrl || (stateno = 730 && power>1000)
triggerall = stateno != [140,159]
trigger1 = enemynear,statetype != L
trigger2 = enemynear,statetype = L && enemynear,alive = 0

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A && ctrl
triggerall = var(20) = 0
triggerall = var(59)=1 && power >= 1000 && random <= (power >= 2000)*10+(power >= 3000)*40+(power >= 4000)*100+(power >= 5000)*1000
trigger1 = enemynear,movetype = H && enemynear,canrecover = 0
trigger2 = enemynear,statetype = L
value = 750

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A && ctrl
triggerall = var(20) = 0
triggerall = var(59)=1 && power >= 2000 && random <= 400+(power >= 3000)*400+(power >= 4000)*200+(power >= 5000)*450
trigger1 = stateno = 240 && movehit
value = 751

;-------------------------------------------
;combo
[state -3,3200]
type = changestate
value = 3200
triggerall = !ishelper
triggerall = var(59)>0 && roundstate = 2 
triggerall = (statetype = S || statetype = C) && power>1000
triggerall = var(20) <= 0
triggerall = enemynear(var(57)),movetype = H
triggerall = helper(30001),var(3) > 65 
triggerall = random < (300 + (power>2000)*200 + (life<lifemax*0.5)*100+(life<lifemax*0.5)*200)
trigger1 = stateno = 1000 && movehit && animelemtime(14)>0
trigger2 = stateno = 1050 && movehit && animelemtime(14)>0
trigger3 = stateno = 1105 && movehit && enemynear(var(57)),pos y > -60
trigger4 = stateno = 1155 && movehit && enemynear(var(57)),pos y > -60

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = power >= 1000 && enemynear,life <= 100
triggerall = enemynear,statetype != A
triggerall = helper(30001),var(7) = 0
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0 && animelem = 11, <= 0
trigger2 = stateno = 1300 && (helper(1306),movehit) && animelemtime(9) >= 0
value = 3100

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = power >= 3000 || (power >= 2000 && var(20))
triggerall = helper(30001),var(7) = 0
trigger1 = stateno = 3060 && movehit && statetype != A
trigger2 = stateno = 1000 && movehit && numtarget(1000) > 0 && enemynear,statetype != A && animelem = 11, <= 0 && random <= 100+(enemynear,life <= 400)*1000
trigger3 = stateno = 1300 && (helper(1306),movehit) && enemynear,statetype != A && hitcount = 6 && random <= 100+(enemynear,life <= 400)*1000
value = 3400-(random <= 300)*100

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = power >= 5000 || (power >= 4000 && var(20) > 0 && var(20) <= 200)
triggerall = enemynear,statetype != A
triggerall = helper(30001),var(7) = 0
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0 && animelem = 11, <= 0
trigger2 = stateno = 1300 && (helper(1306),movehit) && animelemtime(9) >= 0
value = 3050

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1 && random <= 100+(enemynear,life <= 200)*1000
triggerall = power >= 2000 || (power >= 1000 && var(20) > 0 && var(20) <= 200)
triggerall = enemynear,statetype != A
triggerall = helper(30001),var(7) = 0
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0 && animelem = 11, <= 0
trigger2 = stateno = 1300 && (helper(1306),movehit) && animelemtime(9) >= 0
value = 3050

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = var(20) > 0 && var(20) <= 200
triggerall = enemynear,statetype != A
triggerall = helper(30001),var(7) = 0
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0 && animelem = 11, <= 0
trigger2 = stateno = 1300 && (helper(1306),movehit) && animelemtime(9) >= 0
value = 3100


[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1 && random <= 100+(enemynear,life <= 150)*1000
triggerall = power >= 2000 || (power >= 1000 && var(20))
triggerall = helper(30001),var(7) = 0
trigger1 = stateno = 650 && movehit
trigger2 = stateno = 1100 && movehit
value = 3250


[State -3]
type=Changestate
value = ifelse(enemynear(var(57)),life<100,3000+(random%2)*100,3200)
triggerall = Roundstate = 2
triggerall = var(59)=1 && var(20) <= 200 && var(20)>0
triggerall = enemynear(var(57)),movetype = H
triggerall = power < 1000
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0 && animelem = 11, <= 0
trigger2 = stateno = 1300 && (helper(1306),movehit) && animelemtime(9) >= 0

[State -3]
type=Changestate
value = ifelse(enemynear(var(57)),life<150,3050+(random%2)*100,3200)
triggerall = Roundstate = 2
triggerall = var(59)=1 && var(20) <= 200 && var(20)>0 
triggerall = enemynear(var(57)),movetype = H
triggerall = (power = [1000,1999])
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0 && animelem = 11, <= 0
trigger2 = stateno = 1300 && (helper(1306),movehit) && animelemtime(9) >= 0

[State -3]
type=Changestate
value = 3300+(random%2)*100
triggerall = Roundstate = 2
triggerall = var(59)=1 && var(20) <= 200 && var(20)>0 
triggerall = enemynear(var(57)),movetype = H
triggerall = power >= 2000
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0 && animelem = 11, <= 0
trigger2 = stateno = 1300 && (helper(1306),movehit) && animelemtime(9) >= 0

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1 && var(20) > 200
triggerall = enemynear,statetype != A
trigger1 = stateno = 1000 && movehit && numtarget(1000) > 0
value = 1300

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = enemynear,statetype != A
trigger1 = stateno = 250 && movehit
trigger2 = stateno = 1300 && var(20) > 200 && (helper(1306),movehit) && animelemtime(9) >= 0
trigger3 = stateno = 440 && movehit
trigger4 = stateno = 220 && movehit
value = 1000

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = enemynear,statetype = A
trigger1 = stateno = 250 && movehit
value = 1200

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
trigger1 = stateno = 240 && movehit
value = 250

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
trigger1 = stateno = 430 && movehit && enemynear,statetype != A
value = 240

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
trigger1 = stateno = 430 && movehit && enemynear,statetype = A
value = 420

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
trigger1 = stateno = 430 && moveguarded
value = 440

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = helper(33000),var(58)>=2
trigger1 = stateno = 630 && movecontact
value = 640

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = helper(33000),var(58)>=2
trigger1 = stateno = 640 && movecontact
value = 650

[State -3]
type=Changestate
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = statetype = A
triggerall = !ishelper
trigger1 = stateno = 650 && movecontact
trigger2 = (stateno = [600,650]) && movecontact && (helper(33000),var(58)<2)
trigger3 = enemynear(var(57)),movetype = H && (helper(33000),var(58)<2) 
trigger3 = enemynear(var(57)),statetype = A && p2bodydist y >= -10 && (p2bodydist x = [0,45])
value = 1100

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A && ctrl
triggerall = !numtarget(420)
trigger1 = var(59)=1 && random <= 500
trigger1 = P2bodydist X - 7*helper(30001),fvar(0) = [0,50]
trigger1 = P2bodydist Y + helper(30001),fvar(7) = [-75,-20]
trigger1 = enemynear,statetype = A
value = 420

[State -3,对方有速度时]
type = null;ChangeState
triggerall=Roundstate=2
triggerall = statetype != A && ctrl
trigger1 = var(59)=1 && random <= 500
trigger1 = P2bodydist X = [51,80]
trigger1 = P2bodydist Y = [-75,-40]
trigger1 = enemynear,statetype = A && enemynear,vel x > 0
value = 420

[State -3]
type = ChangeState
value = 800
triggerall=Roundstate=2
triggerall = Var(59) = 1 && random <= 990
triggerall = statetype != A
triggerall = stateno != 100
triggerall = enemynear,stateno != [5200,5201]
triggerall = enemynear(var(57)),stateno != helper(30001),var(19)
triggerall = enemynear(var(57)),stateno != helper(30001),var(20)
triggerall = enemynear(var(57)),stateno != helper(30001),var(21)
trigger1 = p2bodydist X = [-2,14]
trigger1 = p2statetype != A && p2statetype != L && p2movetype != H
trigger1 = ctrl

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A && ctrl
triggerall = var(59)=1 
triggerall = enemynear(var(57)),stateno != helper(30001),var(23)
triggerall = enemynear(var(57)),stateno != helper(30001),var(24)
triggerall = enemynear(var(57)),stateno != helper(30001),var(25)
trigger1 = random <= 75+(enemynear,ctrl = 0 && enemynear,animtime >= -9 && enemynear,animtime <= -6)*300+(enemynear,p2dist x < 0)*1000
trigger1 = P2bodydist X - 5*helper(30001),fvar(0) = [0,40]
trigger1 = P2bodydist Y + helper(30001),fvar(5)= [-5,10]
trigger1 = enemynear,statetype != A
trigger1 = enemynear,statetype != L
value = 430

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype = A && ctrl
triggerall = helper(33000),var(58)>=2
trigger1 = var(59)=1 && random <= 690+(numtarget > 0)*1000
trigger1 = P2bodydist X = [0,100]
trigger1 = P2bodydist Y = [-100,10]
trigger1 = enemynear,statetype = A
value = 630

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype = A && ctrl
triggerall = helper(33000),var(58)>=2
trigger1 = var(59)=1 && random <= 690
trigger1 = P2bodydist X = [0,100]
trigger1 = P2bodydist Y = [-40,100]
trigger1 = enemynear,statetype != A
value = 640

[state -3,聚气]
type = changestate
value = 730
triggerall = var(59)>0 && !ishelper
triggerall = Roundstate = 2
triggerall = statetype = S && ctrl
triggerall = power < powermax
triggerall = enemynear(var(57)),movetype != A
triggerall = random < 600
triggerall = var(20) <= 0
triggerall = !numtarget(420)
triggerall = !((enemynear(var(57)),stateno = [1664,1665]) && enemynear(var(57)),movetype = H)
triggerall = !(enemynear(var(57)),movetype != H && enemynear(var(57)),statetype = A)
trigger1 = enemynear(var(57)),movetype = H && enemynear(var(57)),ctrl = 0 && p2bodydist x > 60
trigger2 = helper(30001),fvar(0) < 0
trigger3 = p2bodydist x - 2*helper(30001),fvar(0) > 80

[State -1]
type = ChangeState
value = 930
triggerall = var(59) > 0
triggerall = roundstate = 2
triggerall = alive
triggerall = helper(30001),var(4)=-1;cold down For AI
triggerall = random < 700*(1.0-(life*1.0/lifemax))*.2+(life<lifemax*0.15)*90
triggerall = power >= 1000
trigger1 = life < lifemax*.3 || (life >= lifemax*.8 && enemynear,life >= enemynear,lifemax*.8)
trigger1 = movetype = H
trigger1 = stateno != [120,155]
trigger1 = p2movetype = A
trigger1 = !enemynear,movecontact || enemynear,hitdefattr = SCA,HA,HT,HP || p2stateno%10000 >= 3000
trigger1 = enemynear,projcontacttime(0) <= 0 || enemynear,hitdefattr = SCA,HA,HT,HP || p2stateno%10000 >= 3000
trigger2 = life < lifemax*.1
trigger2 = movetype = H
trigger2 = p2movetype = A
trigger2 = p2stateno%10000 >= 1000 || enemynear,hitdefattr = SCA,SA,HA,SP,HP
;trigger2 = enemynear,hitdefattr = SCA,NA,NP
trigger2 = enemynear,vel x > 0
trigger2 = enemynear,animtime < -10

;Walking AI
[StateDef 19]
type = S
physics = S
moveType = I
ctrl = 0
sprPriority = 0

[State 20, VelSet]
type = VelSet
trigger1 = 1
x = const(velocity.walk.fwd.x)

[State 20, ChangeAnim]
type = ChangeAnim
triggerAll = vel x > 0
trigger1 = (Anim != 20 && Anim != 25) && (Anim != 5 && Anim !=7)
trigger2 = (Anim = 5 || Anim = 7) && AnimElemTime(1) >= 1
value = 20+(var(45))*5

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 3000 || (power >= 2000 && var(20))
triggerall = var(59)=1 && random <= 500+(ctrl = 0 && movecontact)*800
triggerall = P2bodydist X = [0,80]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = 1
trigger2 = (stateno = [200,420]) && moveguarded
value = 3400

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 3000 || (power >= 2000 && var(20))
triggerall = var(59)=1 && random <= 100+(ctrl = 0 && movecontact)*300
triggerall = P2bodydist X = [20,150]
triggerall = P2bodydist Y = [-100,5]
triggerall = enemynear,movetype = A
trigger1 = ctrl
trigger2 = (stateno = [200,420]) && moveguarded
value = 3300

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 2000 || (power >= 1000 && var(20))
triggerall = var(59)=1 && random <= 60+(ctrl = 0 && movecontact)*500
triggerall = P2bodydist X = [0,110]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = 1
trigger2 = (stateno = [200,450]) && moveguarded
value = 3050

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 1000 || var(20)
triggerall = var(59)=1 && random <= 10+(ctrl = 0 && movecontact)*500
triggerall = P2bodydist X = [0,150]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = 1
trigger2 = (stateno = [200,420]) && moveguarded
value = 3100

[State -3]
type = Null;ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = var(59)=1 && random <= 200+(ctrl = 0 && movecontact)*100-(enemynear,vel x > 0)*1000-(enemynear,movecontact)*1000
triggerall = P2bodydist X = [80,120]
triggerall = P2bodydist Y = [-60,5]
triggerall = enemynear,movetype = A && enemynear,animtime <= -11 && enemynear,p2dist x >= 0
trigger1 = 1
trigger2 = (stateno = [200,420]) && moveguarded
value = 1000

[State -3]
Type = ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A&& (ctrl || (StateNo = [100,101])) ;|| (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x >= 0
triggerall = stateno != [140,159]
triggerall = inguarddist && random < 1200 - (life/(lifemax+0.0))*500
triggerall = (helper(30001),var(5)/10)< 4
triggerall = ifelse(life<lifemax*0.5,1,random<500)
trigger1 = P2MoveType = A && p2statetype != A && statetype != A && p2bodydist x >= 120
trigger2 = P2MoveType = A && p2statetype != A && statetype != A & (p2bodydist x = [0,120]); && enemynear,animtime <= -25
trigger3 = P2MoveType = A && statetype != A && enemynear,vel x >= 3
trigger4 = P2MoveType = A && p2statetype = A && p2dist y <= -30 && enemynear,vel x > 0 && frontedgedist >= 100 && statetype != A
Value = 710

[State -3]
Type = ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A&& (ctrl || (StateNo = [100,101])) ;|| (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x < 0
triggerall = stateno != [140,159]
triggerall = enemynear(var(57)),movetype != H
triggerall = (helper(30001),var(5)/10)< 4
triggerall = ifelse(life<lifemax*0.5,1,random<500)
trigger1 = p2statetype = A && p2dist y <= -40 && backedgedist >= 100 && statetype != A
Value = 715

[State -3]
Type = null;ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1 && random <= 1000+(enemynear,stateno != [200,699])*400
triggerall = !ishelper
triggerall = statetype != A
trigger1 = InGuardDist && P2MoveType = A
trigger2 = (enemy,numhelper > 0 || enemy,numproj > 0) && P2MoveType = A
Value = 120
ctrl = 1

[State ガード]
type = ChangeState
value = 120
triggerall = (Roundstate = [2,3]) && statetype != A && alive
triggerall = var(59)
Triggerall = Ctrl || (stateno = 19 || stateno = [102,103])&& (stateno != [120,159])
triggerall = !(((enemynear(var(57)),stateno = [1671,1672]) || (enemynear,stateno = [1664,1665]))&&enemynear(var(57)),movetype = H)
trigger1 = inGuardDist = 1
;	trigger1 = ifelse(var(59)=6,990,(random < (var(59)*95) + 500))
trigger2 = (enemynear(var(57)), HitDefAttr = SCA, AA) && P2BodyDist X = [-80,20]
;	trigger2 = ifelse(var(59)=6,900,(random < (var(59)*10) + 300))
trigger3 = enemynear(var(57)),numproj > 0
;	trigger3 = ifelse(var(59)=6,995,(random < (var(59)*55) + 700))
trigger4 = prevstateno = 5120 && stateno = 0 && time < 4
;	trigger4 = ifelse(var(59)=6,995,(random < (var(59)*55) + 700))

[State -3]
type = Null;ChangeState
value = 102
triggerall = Roundstate = 2
triggerall = var(59)=1 && random <= (enemynear,statetype != A)*60
triggerall = p2bodydist x > 150
triggerall = statetype != A
triggerall = stateno != [140,159]
triggerall = enemynear,movetype != A
trigger1 = enemynear,statetype != L
trigger2 = enemynear,statetype = L && enemynear,alive = 0

[State -3]
type = ChangeState
value = 105
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = p2bodydist x = [0,60]
triggerall = statetype != A
triggerall = enemynear,statetype = L && enemynear,alive = 1
triggerall = Roundstate = 2
triggerall = statetype != A
triggerall = backedgedist >= 60
trigger1 = ctrl

[State -3]
type = ChangeState
value = 38
triggerall = Roundstate = 2
triggerall = enemynear(var(57)),statetype = A
triggerall = enemynear(var(57)),movetype = H
triggerall = enemynear(var(57)),stateno = [1664,1665]
triggerall = var(59)=1
triggerall = p2bodydist x = [70,120]
triggerall = statetype != A
triggerall = helper(33000),var(58)>=2
trigger1 = enemynear(var(57)),pos y < -60

[State -3]
type = ChangeState
value = 39
triggerall = Roundstate = 2
triggerall = enemynear,statetype != A
triggerall = enemynear,movetype = I
triggerall = var(59)=1 && random <= 30+(enemynear,statetype = C)*20 + 30*(life/(lifemax+0.0))
triggerall = p2bodydist x = [60,140]
triggerall = statetype != A
trigger1 = enemynear,statetype != L
trigger2 = enemynear,statetype = L && enemynear,alive = 0

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = var(20) = 0
triggerall = var(59)=1 && power >= 1000 && random <= (power >= 2000)*10+(power >= 3000)*40+(power >= 4000)*100+(power >= 5000)*1000
trigger1 = enemynear,movetype = H && enemynear,canrecover = 0
trigger2 = enemynear,statetype = L
value = 750

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = !(target,ID = 420)
trigger1 = var(59)=1 && random <= 500
trigger1 = P2bodydist X - 7*helper(30001),fvar(0) = [0,50]
trigger1 = P2bodydist Y + helper(30001),fvar(7) = [-75,-20]
trigger1 = enemynear,statetype = A
value = 420

[State -3,对方有速度时]
type = null;ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
trigger1 = var(59)=1 && random <= 500
trigger1 = P2bodydist X = [51,80]
trigger1 = P2bodydist Y = [-75,-40]
trigger1 = enemynear,statetype = A && enemynear,vel x > 0
value = 420

[State -3]
type = ChangeState
value = 800
triggerall=Roundstate=2
triggerall = Var(59) = 1 && random <= 990
triggerall = statetype != A
triggerall = stateno != 100
triggerall = enemynear,stateno != [5200,5201]
triggerall = enemynear(var(57)),stateno != helper(30001),var(19)
triggerall = enemynear(var(57)),stateno != helper(30001),var(20)
triggerall = enemynear(var(57)),stateno != helper(30001),var(21)
trigger1 = p2bodydist X = [-2,14]
trigger1 = p2statetype != A && p2statetype != L && p2movetype != H

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = enemynear(var(57)),stateno != helper(30001),var(23)
triggerall = enemynear(var(57)),stateno != helper(30001),var(24)
triggerall = enemynear(var(57)),stateno != helper(30001),var(25)
trigger1 = var(59)=1 && random <= 75+(enemynear,ctrl = 0 && enemynear,animtime >= -9 && enemynear,animtime <= -6)*300+(enemynear,p2dist x < 0)*1000
trigger1 = P2bodydist X - 5*helper(30001),fvar(0) = [0,40]
trigger1 = P2bodydist Y + helper(30001),fvar(5) = [-5,10]
trigger1 = enemynear,statetype != A
trigger1 = enemynear,statetype != L
value = 430

[State 100, Change to Walk Stop]
type=ChangeState
trigger1 = roundstate > 2
trigger2 = p2bodydist x <= 15
value=0
ctrl=1


;jumping long AI
[StateDef 36]
type = S
physics = S
moveType = I
anim = 40+(var(45))*8
ctrl = 0
velSet = 0,0
sprPriority = 1
faceP2 = 1

[State 731, StopSnd]
type = StopSnd
trigger1 = !Time
channel = 0

[State 40, Snd]
type = playsnd
trigger1 = !animtime
value = ifelse((var(3) = [2, 3]), 41, 40), 0
[State 40, Dust]
type = helper
trigger1 = !animtime
helpertype = normal
stateno = 8100
ID = 8100
name = "Jump Dust"
postype = p1
ownpal = 1

[State 40, Vel Normal]
type = velset
trigger1 = !animtime
x = 1.2*const(velocity.runjump.fwd.x)
y = const(velocity.jump.y)

[State 40, End]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = 1

;jumping up AI
[StateDef 37]
type = S
physics = S
moveType = I
anim = 40+(var(45))*8
ctrl = 0
velSet = 0,0
sprPriority = 1
faceP2 = 1

[State 40, Snd]
type = playsnd
trigger1 = !animtime
value = ifelse((var(3) = [2, 3]), 41, 40), 0
[State 40, Dust]
type = helper
trigger1 = !animtime
helpertype = normal
stateno = 8100
ID = 8100
name = "Jump Dust"
postype = p1
ownpal = 1

[State 40, Vel Normal]
type = velset
trigger1 = !animtime
x = 0
y = const(velocity.jump.y)

[State 40, End]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = 1


;jumping high AI
[StateDef 38]
type = S
physics = S
moveType = I
anim = 40+(var(45))*8
ctrl = 0
velSet = 0,0
sprPriority = 1
faceP2 = 1

[State 40, Snd]
type = playsnd
trigger1 = !animtime
value = ifelse((var(3) = [2, 3]), 41, 40), 0
[State 40, Dust]
type = helper
trigger1 = !animtime
helpertype = normal
stateno = 8100
ID = 8100
name = "Jump Dust"
postype = p1
ownpal = 1

[State 40, Vel Normal]
type = velset
trigger1 = !animtime
x = const(velocity.runjump.fwd.x)
y = const(velocity.jump.y)

[State 40, End]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = 1



;jumping Low AI
[StateDef 39]
type = S
physics = S
moveType = I
anim =40+(var(45))*8
ctrl = 0
velSet = 0,0
sprPriority = 1
faceP2 = 1

[State 731, StopSnd]
type = StopSnd
trigger1 = !Time
channel = 0

[State 40, Snd]
type = playsnd
trigger1 = !animtime
value = ifelse((var(3) = [2, 3]), 41, 40), 0
[State 40, Dust]
type = helper
trigger1 = !animtime
helpertype = normal
stateno = 8100
ID = 8100
name = "Jump Dust"
postype = p1
ownpal = 1

[State 40, Vel Medium]
type = velset
trigger1 = !animtime
x = const(velocity.runjump.fwd.x)
y = 0.76 * const(velocity.jump.y)

[State 40, End]
type = ChangeState
trigger1 = !AnimTime
value = 50
ctrl = 1



;Running AI
[Statedef 102]
type    = S
movetype = I
physics = S
ctrl = 0
VelSet = 0,0

[State 100, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
value = 100+(var(45))*2

[State 100, Velocity]
type = VelSet
trigger1 = AnimElem = 2 >= 0
x = Const(velocity.run.fwd.x)

[State 100, Change to Run Stop]
type=ChangeState
trigger1 = roundstate > 2
value=103
ctrl=0

[State 110, Dust Helper]
type = Helper
trigger1 = AnimElem = 2
helperType = Normal
stateNo = 8103
ID = 8100
name = "Dash Dust"
posType = P1
pos = ceil(-73 * const(size.xScale)) ,0
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1

[State 105, Starting Step snd]
type = PlaySnd
trigger1 = !Time
value = 102, 0
channel = 5

[State 105, Step snd]
type = PlaySnd
trigger1 = AnimElem = 2
value = 100,2
channel = 6

[State -3]
type = ChangeState
value = 105
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = prevstateno = 420 && numtarget > 0 && time >= 11
triggerall = enemynear,statetype = A && enemynear,alive = 1
triggerall = statetype != A
triggerall = backedgedist >= 60
trigger1 = helper(33000),var(58)<2

[State -3]
type = ChangeState
value = 38
triggerall = Roundstate = 2
triggerall = prevstateno = 420 && numtarget > 0 && time >= 11
triggerall = var(59)=1
triggerall = statetype != A
triggerall = (helper(30001),var(1)>70 && helper(30001),var(2)>70) || helper(30001),var(3) > 15
triggerall = helper(33000),var(58)>=2
trigger1 = 1

[State -3]
type = ChangeState
value = 37
triggerall = Roundstate = 2
triggerall = prevstateno = 420 && numtarget > 0 && time >= 11
triggerall = var(59)=1
triggerall = statetype != A
triggerall = (helper(30001),var(1)<=70 || helper(30001),var(2)<=70) && helper(30001),var(3) <= 15
triggerall = helper(33000),var(58)>=2
trigger1 = 1

[State 100, No Walk During Run]
type = AssertSpecial
trigger1 = 1
flag = NoWalk





;Run Stop AI
[Statedef 103]
type = S
movetype = I
physics = S

[State 101, Skid Snd]
type = PlaySnd
trigger1 = !Time
value = 101,0

[State 101, Skid Dust]
type = Explod
trigger1 = !Time
anim = 8104
sprPriority=3
posType = P1
pos = ceil(-80 * const(size.xScale)), ceil(8 * const(size.yScale))
vel = 0,0
scale = 0.5,0.5
pauseMovetime = -1
superMoveTime = -1
ownpal = 1

[State 101, ChangeAnim]
type = ChangeAnim
trigger1 = !Time
value = 101+(var(45))*2

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 3000 || (power >= 2000 && var(20))
triggerall = var(59)=1 && random <= 500+(ctrl = 0 && movecontact)*800
triggerall = P2bodydist X = [0,80]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = 1
trigger2 = (stateno = [200,420]) && moveguarded
value = 3400

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 3000 || (power >= 2000 && var(20))
triggerall = var(59)=1 && random <= 100+(ctrl = 0 && movecontact)*300
triggerall = P2bodydist X = [20,150]
triggerall = P2bodydist Y = [-100,5]
triggerall = enemynear,movetype = A
trigger1 = ctrl
trigger2 = (stateno = [200,420]) && moveguarded
value = 3300

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = power >= 1000 || var(20)
triggerall = var(59)=1 && random <= 50+(ctrl = 0 && movecontact)*500
triggerall = P2bodydist X = [0,150]
triggerall = P2bodydist Y = [-5,5]
triggerall = enemynear,statetype != A && enemynear,movetype = A
trigger1 = 1
trigger2 = (stateno = [200,420]) && moveguarded
value = 3100

[State -3]
Type = ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A&& (ctrl || (StateNo = [100,101])) ;|| (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x >= 0
triggerall = enemynear,stateno < 2000
triggerall = stateno != [140,159]
triggerall = inguarddist && random < 1200 - (life/(lifemax+0.0))*500
triggerall = (helper(30001),var(5)/10)< 4
triggerall = ifelse(life<lifemax*0.5,1,random<500)
trigger1 = P2MoveType = A && p2statetype != A && statetype != A && enemynear,hitdefattr != SCA,NT,ST,HT && p2bodydist x >= 120
trigger2 = P2MoveType = A && p2statetype != A && statetype != A && enemynear,hitdefattr != SCA,NT,ST,HT && (p2bodydist x = [0,120]) && enemynear,animtime <= -25
trigger3 = P2MoveType = A && p2statetype = A && p2dist y <= -30 && enemynear,vel x > 0 && frontedgedist >= 100 && statetype != A
Value = 710

[State -3]
Type = ChangeState
triggerall = Roundstate = 2
triggerall = var(59)=1
triggerall = !ishelper
triggerall = statetype != A&& (ctrl || (StateNo = [100,101])) ;|| (stateno = 700 && animelem = 4,>0) || (stateno = 710 && animelem = 6,>0) || (stateno = 715 && animelem = 7,>0))
triggerall = p2dist x >= 0
triggerall = enemynear,p2dist x < 0
triggerall = enemynear,stateno < 2000
triggerall = stateno != [140,159]
triggerall = enemynear(var(57)),movetype != H
triggerall = (helper(30001),var(5)/10)< 4
triggerall = ifelse(life<lifemax*0.5,1,random<500)
trigger1 = p2statetype = A && p2dist y <= -40 && backedgedist >= 100 && statetype != A
Value = 715

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = !(target,ID = 420)
trigger1 = var(59)=1 && random <= 500
trigger1 = P2bodydist X - 7*helper(30001),fvar(0) = [0,50]
trigger1 = P2bodydist Y + helper(30001),fvar(7) = [-75,-20]
trigger1 = enemynear,statetype = A
value = 420

[State -3]
type = null;ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
trigger1 = var(59)=1 && random <= 500
trigger1 = P2bodydist X = [51,80]
trigger1 = P2bodydist Y = [-75,-40]
trigger1 = enemynear,statetype = A && enemynear,vel x > 0
value = 420

[State -3]
type = ChangeState
value = 800
triggerall=Roundstate=2
triggerall = Var(59) = 1 && random <= 990
triggerall = statetype != A
triggerall = stateno != 100
triggerall = enemynear,stateno != [5200,5201]
triggerall = enemynear(var(57)),stateno != helper(30001),var(19)
triggerall = enemynear(var(57)),stateno != helper(30001),var(20)
triggerall = enemynear(var(57)),stateno != helper(30001),var(21)
trigger1 = p2bodydist X = [-2,14]
trigger1 = p2statetype != A && p2statetype != L && p2movetype != H

[State -3]
type = ChangeState
triggerall=Roundstate=2
triggerall = statetype != A
triggerall = enemynear(var(57)),stateno != helper(30001),var(23)
triggerall = enemynear(var(57)),stateno != helper(30001),var(24)
triggerall = enemynear(var(57)),stateno != helper(30001),var(25)
trigger1 = var(59)=1 && random <= 200+(enemynear,ctrl = 0 && enemynear,animtime >= -9 && enemynear,animtime <= -6)*300+(enemynear,stateno = 52)*1000+(enemynear,p2dist x < 0)*1000
trigger1 = P2bodydist X - 5*helper(30001),fvar(0) = [0,50]
trigger1 = P2bodydist Y + helper(30001),fvar(5) = [-5,10]
trigger1 = enemynear,statetype != A
trigger1 = enemynear,statetype != L
value = 430

[State 101, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1
