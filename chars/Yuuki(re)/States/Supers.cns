;------------------------------------------------------------------
;Vertical Square
[Statedef 3000]
type=S
movetype=A
physics=N
ctrl=0
anim=3000
velset=0,0
poweradd=-1000
sprpriority=2
facep2=1

[State 3000, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3000, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3000, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3000, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3000, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3000, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3000, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8500
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-10 * const(size.xScale)), ceil(-218 * const(size.yScale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3000, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,0
darken=0
poweradd=0

[State 3000, NotHitBy]
type=NotHitBy
trigger1=AnimElemTime(3) < 0
time=1
value=SCA

[State 1000, Helper]
type = Helper
triggerall = !numhelper(7000)
trigger1 =animelem=3
trigger2 =animelem=10
trigger3 =animelem=19
helpertype = normal ;player
name ="Light"
ID =7000
stateno =7000
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=1

[State 1000, Helper]
type = Helper
trigger1 =animelem=3
helpertype = normal ;player
name ="slash"
ID =1030
stateno =1030
pos = 0,0
postype = p1
ownpal = 1
persistent=0
[State 1000, Helper]
type = Helper
trigger1 =animelem=10
helpertype = normal ;player
name ="slash"
ID =1031
stateno =1031
pos = 0,0
postype = p1
ownpal = 1
persistent=0
[State 1000, Helper]
type = Helper
trigger1 =animelem=13
helpertype = normal ;player
name ="slash"
ID =1032
stateno =1032
pos = 0,0
postype = p1
ownpal = 1
persistent=0
[State 1000, Helper]
type = Helper
trigger1 =animelem=19
helpertype = normal ;player
name ="slash"
ID =1033
stateno =1033
pos = 0,0
postype = p1
ownpal = 1
persistent=0

[State 1000, Square FX]
type=Helper
trigger1=movehit=1 && numtarget(3003)
trigger1=(enemynear, movetype=H) && !(target, time)
helperType=Normal
stateNo=1035
ID=1035
name="Square"
pos = ceil(p2dist x),ceil(p2dist y-54)
postype = p1
ownPal=1
size.xscale = 0.6
size.yscale = 0.15
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1
persistent=0

[State 3000, Voice]
type = PlaySnd
trigger1 = AnimElem=1
value = 1000,3
channel = 0
[State 3000, Voice]
type = PlaySnd
trigger1 = AnimElem=19
value = 1000,4
channel = 0
[State 3000, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=3 || AnimElem=10 || AnimElem=13
value = 1,8
channel = 1
[State 3000, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=19
value = 1,9
channel = 1

[State 3000, Landing Sound]
type=PlaySnd
trigger1=animelem=10|animelem=17
value=52,0
[State 3000, Landing Dust Explod]
type=Explod
trigger1=animelem=10|animelem=17
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1


[State 3000, Dust Helper]
type = Helper
trigger1 = Animelem =19
helperType = Normal
stateNo = 8103
ID = 8100
name = "Dash Dust"
posType = P1
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1
[State 3000, Starting Step snd]
type = PlaySnd
trigger1 = Animelem =19
value = 102, 0
channel = 5

[State 3000, Skid Snd]
type = PlaySnd
trigger1 = AnimElem = 23
value = 101,0
[State 3000, Skid Dust]
type = Explod
trigger1 = AnimElem = 23
anim = 8104
sprPriority=3
posType = P1
pos = -10,3
vel = 0,0
scale = 0.5,0.5
pauseMovetime = -1
superMoveTime = -1
ownpal = 1

[State 3000, VelSet]
type = VelSet
trigger1 =animelem=2
x = 11
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=5
x = 11
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=13|animelem=17
x = 0
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=14
x = -6
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=19
x = 10
[State 3000, Velmul]
type = Velmul
trigger1 =animelem=2, >=0 && animelem=13, <0
x = .9
[State 3000, Velmul]
type = Velmul
trigger1 =animelem=22, >=0
x = .8

[State 3000, width]
type = width
trigger1 = animelemtime(14)<0
value = 5, 0
ignorehitpause = 1

[State 3000, Hit]
type=HitDef
trigger1=animelem=3
attr=S, HA
damage=47, 11
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=9, 9
guardflag=MA
hitflag=MAF
hitsound = S2,15
guardsound=S130,0
pauseTime=3,16
guard.pauseTime=3,16
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=88), var(36) :=-55
air.animtype=Back
fall.animtype=Back
ground.type=Low
air.type=Low
ground.slidetime=2
ground.hittime =16
guard.hittime=16
ground.velocity=0
air.velocity=0,Ifelse(var(20),-1,0)
guard.velocity=-1
airguard.velocity =0, -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=Ifelse(var(20),.35,.5)
air.fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3000, Hit]
type=HitDef
trigger1=animelem=10
attr=S, HA
damage=47, 11
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=9, 9
guardflag=MA
hitflag=MAF
hitsound = S2,15
guardsound=S130,0
pauseTime=3,16
guard.pauseTime=3,16
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=90), var(36) :=-63
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=2
ground.hittime =16
guard.hittime=16
ground.velocity=0
air.velocity=0,Ifelse(var(20),-1,0)
guard.velocity=-1
airguard.velocity =0, -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=Ifelse(var(20),.35,.5)
air.fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3000, Hit]
type=HitDef
trigger1=animelem=13
attr=S, HA
damage=47, 11
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=9, 9
guardflag=MA
hitflag=MAF
hitsound = S2,15
guardsound=S130,0
pauseTime=3,13
guard.pauseTime=3,13
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=87), var(36) :=-67
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=10
ground.hittime =10
guard.hittime=10
ground.velocity=2,-5
air.velocity=2,-4.5
guard.velocity=4
airguard.velocity =2, -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=.5
fall=1
air.fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3000, HitDef]
type = HitDef
attr = S, HA
trigger1 = animelem=19
animtype = Hard
damage = 50, 15
getpower=0, 0
givepower=12, 12
priority=4, hit
guardflag = MA
pausetime = 12,12
sparkNo = -1 + 0 * (var(33) := 8024)
sparkXY = -10 + 0 * (var(35) := 92), var(36) := -58
guard.sparkNo = -1 + 0 * (var(34) := 8001)
hitsound=S2+10*var(44),14
guardsound = s130, 2
ground.type = high
ground.slidetime = 20
ground.hittime  = 20
guard.hittime = 16
ground.velocity=Ifelse(var(20),-2.5,-6),Ifelse(var(20),-5.5,-2.5)
guard.velocity=Ifelse(var(20),-2.5,-8)
air.velocity = Ifelse(var(20),-1.2,-6),-2
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
air.fall = 1
yaccel = .49
palFX.time = 12 * var(9)
palFX.add = 255, 255, 255
palFX.sinAdd = -255, -255, -255, 48
envshake.time=14
envshake.ampl=4
envShake.freq=120
id = 3003

[State 3000, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(23) = 0
moveType=I

[State 3000, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1
;------------------------------------------------------------------
;Max Vertical Square
[Statedef 3050]
type=S
movetype=A
physics=N
ctrl=0
anim=3050
velset=0,0
poweradd=-2000
sprpriority=2
facep2=1

[State 3000, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3000, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3000, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3000, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3000, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3000, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3000, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8510
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-10 * const(size.xScale)), ceil(-218 * const(size.yScale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3000, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,1
darken=0
poweradd=0

[State 3000, NotHitBy]
type=NotHitBy
trigger1=AnimElemTime(3) < 0
time=1
value=SCA

[State 1000, Helper]
type = Helper
triggerall = !numhelper(7000)
trigger1 =animelem=3
trigger2 =animelem=10
trigger3 =animelem=19
helpertype = normal ;player
name ="Light"
ID =7000
stateno =7000
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=1

[State 1000, Helper]
type = Helper
trigger1 =animelem=3
helpertype = normal ;player
name ="slash"
ID =1030
stateno =1030
pos = 0,0
postype = p1
ownpal = 1
persistent=0
[State 1000, Helper]
type = Helper
trigger1 =animelem=10
helpertype = normal ;player
name ="slash"
ID =1031
stateno =1031
pos = 0,0
postype = p1
ownpal = 1
persistent=0
[State 1000, Helper]
type = Helper
trigger1 =animelem=13
helpertype = normal ;player
name ="slash"
ID =1032
stateno =1032
pos = 0,0
postype = p1
ownpal = 1
persistent=0
[State 1000, Helper]
type = Helper
trigger1 =animelem=19
helpertype = normal ;player
name ="slash"
ID =1033
stateno =1033
pos = 0,0
postype = p1
ownpal = 1
persistent=0

[State 1000, Square FX]
type=Helper
trigger1=movehit=1 && numtarget(3003)
trigger1=(enemynear, movetype=H) && !(target, time)
helperType=Normal
stateNo=1035
ID=1035
name="Square"
pos = ceil(p2dist x),ceil(p2dist y-54)
postype = p1
ownPal=1
size.xscale = 0.6
size.yscale = 0.15
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1
persistent=0

[State 3000, Voice]
type = PlaySnd
trigger1 = AnimElem=1
value = 1000,3
channel = 0
[State 3000, Voice]
type = PlaySnd
trigger1 = AnimElem=23
value = 1000,5
channel = 0
[State 3000, Voice]
type = PlaySnd
trigger1 = AnimElem=31
value = 1000,6
channel = 0
[State 3000, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=3 || AnimElem=10 || AnimElem=13
value = 1,8
channel = 1
[State 3000, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=19
value = 1,9
channel = 1

[State 3000, Landing Sound]
type=PlaySnd
trigger1=animelem=10|animelem=17
value=52,0
[State 3000, Landing Dust Explod]
type=Explod
trigger1=animelem=10|animelem=17
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1


[State 3000, Dust Helper]
type = Helper
trigger1 = Animelem =19
helperType = Normal
stateNo = 8103
ID = 8100
name = "Dash Dust"
posType = P1
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1
[State 3000, Starting Step snd]
type = PlaySnd
trigger1 = Animelem =19
value = 102, 0
channel = 5

[State 3000, VelSet]
type = VelSet
trigger1 =animelem=2
x = 11
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=5
x = 11
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=13|animelem=17
x = 0
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=14
x = -6
[State 3000, VelSet]
type = VelSet
trigger1 =animelem=19
x = 10
[State 3000, Velmul]
type = Velmul
trigger1 =animelem=2, >=0 && animelem=13, <0
x = .9
[State 3000, Velmul]
type = Velmul
trigger1 =animelem=21, >=0
x = .8

[State 3000, width]
type = width
trigger1 = animelemtime(14)<0
value = 5, 0
ignorehitpause = 1

[State 3050, StateTypeSet];Air, no physics
type = StateTypeSet
trigger1 = AnimElem = 24
statetype = A
physics = N

[State 3050, Up Snd]
type=PlaySnd
trigger1=Animelem=24
value=41,0
[State 3050, Dust Helper]
type=Helper
trigger1=animelem=24
helperType=Normal
stateNo=8100
ID=8100
name="Jump Dust"
posType=P1
ownPal=1
pos = -30,0

[State 3050, Push Helper (Vel X)]
type = helper
trigger1 = !numhelper(3056)
trigger1 = animelemtime(24)>=0
helpertype = player
stateno = 3056
ID = 3056
name = "Blast Push Helper"
postype = p1
pos = 0,0
ownpal = 1

[State 3050, Helper]
type = Helper
triggerall = !numhelper(7000)
trigger1 =animelem=30
helpertype = normal ;player
name ="Light"
ID =7000
stateno =7000
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=1

[State 3050, Helper]
type = Helper
trigger1 =animelem=31
helpertype = normal ;player
name ="slash"
ID =3055
stateno =3055
pos = 0,0
postype = p1
ownpal = 1
persistent=0

[State 3050, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=31
value = 1,9
channel = 1

[State 3050, VelSet]
type = VelSet
trigger1 =animelem=24
y = -8

[State 3050, PosSet]
type = PosSet
trigger1 =numhelper(3056)
x = helper(3056),pos x

[State 0, Gravity]
type = veladd
trigger1 = animelemtime(24)>0 && animelemtime(27)<0
y = 1.25

[State 0, Gravity]
type = veladd
trigger1 = animelemtime(27)>=0 && animelemtime(32)<0
y = 0.15

[State 0, Gravity]
type = veladd
trigger1 = animelemtime(32)>=0
y = 0.35

[State 3000, Hit]
type=HitDef
trigger1=animelem=3
attr=S, HA
damage=47, 11
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=9, 9
guardflag=MA
hitflag=MAF
hitsound = S2,15
guardsound=S130,0
pauseTime=3,16
guard.pauseTime=3,16
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=88), var(36) :=-55
air.animtype=Back
fall.animtype=Back
ground.type=Low
air.type=Low
ground.slidetime=2
ground.hittime =16
guard.hittime=16
ground.velocity=0
air.velocity=0,Ifelse(var(20),-1,0)
guard.velocity=-1
airguard.velocity =0, -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=Ifelse(var(20),.35,.5)
air.fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3000, Hit]
type=HitDef
trigger1=animelem=10
attr=S, HA
damage=47, 11
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=9, 9
guardflag=MA
hitflag=MAF
hitsound = S2,15
guardsound=S130,0
pauseTime=3,16
guard.pauseTime=3,16
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=90), var(36) :=-63
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=2
ground.hittime =16
guard.hittime=16
ground.velocity=0
air.velocity=0,Ifelse(var(20),-1,0)
guard.velocity=-1
airguard.velocity =0, -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=Ifelse(var(20),.35,.5)
air.fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3000, Hit]
type=HitDef
trigger1=animelem=13
attr=S, HA
damage=47, 11
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=9, 9
guardflag=MA
hitflag=MAF
hitsound = S2,15
guardsound=S130,0
pauseTime=3,13
guard.pauseTime=3,13
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=87), var(36) :=-67
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=10
ground.hittime =10
guard.hittime=10
ground.velocity=2,-5
air.velocity=2,-4.5
guard.velocity=4
airguard.velocity =2, -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=.5
fall=1
air.fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3000, HitDef]
type = HitDef
attr = S, HA
trigger1 = animelem=19
animtype = Hard
damage = 50, 15
getpower=0, 0
givepower=12, 12
priority=4, hit
guardflag = MA
pausetime = 12,12
sparkNo = -1 + 0 * (var(33) := 8024)
sparkXY = -10 + 0 * (var(35) := 92), var(36) := -58
guard.sparkNo = -1 + 0 * (var(34) := 8001)
hitsound=S2+10*var(44),14
guardsound = s130, 2
ground.type = high
ground.slidetime = 20
ground.hittime  = 20
guard.hittime = 16
ground.velocity=-3,-6
guard.velocity=Ifelse(var(20),-2.5,-8)
air.velocity = -3,-5
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
air.fall = 1
yaccel = .49
palFX.time = 12 * var(9)
palFX.add = 255, 255, 255
palFX.sinAdd = -255, -255, -255, 48
envshake.time=14
envshake.ampl=4
envShake.freq=120
id = 3003

[State 3050, Hit]
type = HitDef
trigger1 = animelem=24
attr = A, HA
damage = 35, 10
priority = 4, hit
animtype = Hard
getpower=0, 0
givepower = 12, 12
guardflag = MA
hitflag = MAF
hitsound = s2+10*var(44),2
guardsound = S130,0
pausetime = Ifelse(var(20),6,12),Ifelse(var(20),6,12)
guard.pausetime = Ifelse(var(20),6,12),Ifelse(var(20),6,12)
sparkNo = -1 + 0 * (var(33) := 8014)
guard.sparkNo = -1 + 0 * (var(34) := 8001)
sparkXY = -10 + 0 * (var(35) := ceil(132*const(size.xScale))), var(36):=ceil(-212*const(size.yScale))
air.animtype = Back
fall.animtype = Back
ground.type = Low
air.type = Low
ground.slidetime = 9
ground.hittime  = 9
guard.hittime = 9
ground.velocity = Ifelse(var(20),-2,-3), -5
air.velocity = Ifelse(var(20),-2,-3),-5
guard.velocity = Ifelse(var(20),-3,-6)
ground.cornerPush.velOff = 0
guard.cornerPush.velOff = 0
air.cornerPush.velOff = 0
yaccel = Ifelse(var(20),.5,.5)
fall = 1
fall.recover = 0
forcestand = 1
palFX.time = 12 * var(9)
palFX.add = 255,255,255
palFX.sinAdd= -255,-255,-255,48
envshake.time = 14
envshake.ampl = 4
envShake.freq = 120

[State 3050, Hit]
type=HitDef
trigger1=animelem=31
attr=A, HA
damage = 65,10
priority=4, hit
animtype=Hard
getpower=0,0
givepower=12, 12
guardflag=HA
hitflag=MAF
hitsound = S2+10*var(44),14
guardsound=S130,2
pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
guard.pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=60), var(36) :=-33
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=20
ground.hittime =20
guard.hittime=17
ground.velocity=-4,-4.5
air.velocity=-4,9
guard.velocity=Ifelse(var(20),-3,-6)
airguard.velocity =Ifelse(var(20),-3,-6), -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=.5
fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3000, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(32) = 0
moveType=I

[State 3000, End]
type = ChangeState
trigger1 = Pos y>-Vel y
value = 3054
;------------------------------------------------------------------
; Land
[Statedef 3054]
type=S
movetype=I
physics =S
anim=3054
ctrl=0
velset=0,0

[State 1301, PosSet]
type=PosSet
trigger1 =1
y=0
[State 1301, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 1301, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 1301, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;------------------------------------------------------------------
;Super Vorpal Strike
[Statedef 3100]
type=A
movetype=A
physics=N
ctrl=0
anim=3100
velset=0,0
poweradd=-1000
sprpriority=1
facep2=1

[State 3000, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3000, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3000, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3000, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3000, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3000, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3100, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8500
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-21*const(size.xscale)), ceil(-252*const(size.yscale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3100, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,0
darken=0
poweradd=0

[State 3100, NHB]
type = NotHitBy
trigger1=animelemtime(4)<=0
value = SCA
time = 1

[State 3100, Voice]
type=PlaySnd
trigger1 =animelem=1
value=1100,2
channel=0
[State 3100, SND]
type=PlaySnd
trigger1 =animelem=4
value=1,7
channel=1

[State 3100, VelSet]
type = VelSet
trigger1 =Animelem =1
x = -.25
y = -.15

[State 3100, VelSet]
type = VelSet
trigger1 =Animelem =3
x = 16
y = 0

[State 3100, VelSet]
type = VelAdd
trigger1 =Animelem =6, >=0 && vel x >= 3
x = -2

[State 3100, Starting Step snd]
type = PlaySnd
trigger1 = Animelem =3
value = 100, 2
channel = 5

[State 3100, Vorpal Strike FX]
type = helper
trigger1 = animelemtime(4)=0
helpertype = normal
stateno = 3105
ID = 3105
name = "VorpalStrikeFX"
postype = p1
pos = 0,0
ownpal = 1

[State 3100, Helper]
type = Helper
triggerall = !numhelper(7001)
trigger1 =animelem=4
helpertype = normal ;player
name ="Light"
ID =7001
stateno =7001
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=0


[State 3100, VarSet]
type = VarSet
trigger1 = !Time
var(24) = 0
ignoreHitPause = 1
[State 3100, VarAdd]
type = VarAdd
trigger1 = MoveContact=1
trigger2 = MoveReversed=1
var(24) = 1
ignoreHitPause = 0

[State 3100, HitDef]
type = HitDef
attr = A, HA
trigger1 = !(movecontact%2)
animtype = Hard
damage = 32,8
getpower=0, 0
givepower=22, 22
priority=4, hit
guardflag = MA
pausetime = 5,9
guard.pausetime = 5,5
sparkNo = -1 + 0 * (var(33) := 8024)
sparkXY = -10 + 0 * (var(35) := 122), var(36) := -72
guard.sparkNo = -1 + 0 * (var(34) := 8001)
hitsound=S2+10*var(44),14
guardsound = s130, 2
ground.type = high
ground.slidetime = 20
ground.hittime  = 20
guard.hittime = 15
ground.velocity=Ifelse(var(20),-2.5,-8),Ifelse(var(20),-5.5,-2.5)
guard.velocity=Ifelse(var(20),-2.5,-7)
air.velocity = Ifelse(var(20),-1.2,-8),Ifelse(var(20),-3.5,-0.5)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
air.fall = 1
yaccel = .49
palFX.time = 12 * var(9)
palFX.add = 255, 255, 255
palFX.sinAdd = -255, -255, -255, 48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3100, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(6)=0
movetype=I

[State 3100, Gravity]
type=Gravity
trigger1=AnimElemTime(6)>=0

[State 3100, Change]
type=ChangeState
trigger1=Pos y>-Vel y
value=3104
;------------------------------------------------------------------
; Land
[Statedef 3104]
type=S
movetype=I
physics =S
anim=3104
ctrl=0
velset=0,0

[State 1104, PosSet]
type=PosSet
trigger1 =1
y=0
[State 1104, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 1104, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 1104, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;------------------------------------------------------------------
;Max Super Vorpal Strike
[Statedef 3150]
type=A
movetype=A
physics=N
ctrl=0
anim=3100
velset=0,0
poweradd=-2000
sprpriority=1
facep2=1

[State 3000, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3000, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3000, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3000, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3000, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3000, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3100, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8510
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-21*const(size.xscale)), ceil(-252*const(size.yscale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3100, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,1
darken=0
poweradd=0

[State 3100, NHB]
type = NotHitBy
trigger1=animelemtime(4)<=0
value = SCA
time = 1

[State 3100, Voice]
type=PlaySnd
trigger1 =animelem=1
value=1100,2
channel=0
[State 3100, SND]
type=PlaySnd
trigger1 =animelem=4
value=1,7
channel=1

[State 3100, VelSet]
type = VelSet
trigger1 =Animelem =1
x = -.25
y = -.15

[State 3100, VelSet]
type = VelSet
trigger1 =Animelem =3
x = 16
y = 0

[State 3100, VelSet]
type = VelAdd
trigger1 =Animelem =6, >=0 && vel x >= 3
x = -2

[State 3100, Starting Step snd]
type = PlaySnd
trigger1 = Animelem =3
value = 100, 2
channel = 5

[State 3100, Vorpal Strike FX]
type = helper
trigger1 = animelemtime(4)=0
helpertype = normal
stateno = 3105
ID = 3105
name = "VorpalStrikeFX"
postype = p1
pos = 0,0
ownpal = 1

[State 3100, Helper]
type = Helper
triggerall = !numhelper(7001)
trigger1 =animelem=4
helpertype = normal ;player
name ="Light"
ID =7001
stateno =7001
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=0


[State 3100, VarSet]
type = VarSet
trigger1 = !Time
var(24) = 0
ignoreHitPause = 1
[State 3100, VarAdd]
type = VarAdd
trigger1 = MoveContact=1
trigger2 = MoveReversed=1
var(24) = 1
ignoreHitPause = 0

[State 3100, HitDef]
type = HitDef
attr = A, HA
trigger1 = !(movecontact%2)
animtype = Hard
damage = 32,8
getpower=0, 0
givepower=22, 22
priority=4, hit
guardflag = MA
pausetime = 5,9
guard.pausetime = 5,5
sparkNo = -1 + 0 * (var(33) := 8024)
sparkXY = -10 + 0 * (var(35) := 122), var(36) := -72
guard.sparkNo = -1 + 0 * (var(34) := 8001)
hitsound=S2+10*var(44),14
guardsound = s130, 2
ground.type = high
ground.slidetime = 20
ground.hittime  = 20
guard.hittime = 15
ground.velocity=Ifelse(var(20),-2.5,-8),Ifelse(var(20),-5.5,-6.5)
guard.velocity=Ifelse(var(20),-2.5,-7)
air.velocity = Ifelse(var(20),-1.2,-8),Ifelse(var(20),-3.5,-6.5)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
air.fall = 1
yaccel = .49
palFX.time = 12 * var(9)
palFX.add = 255, 255, 255
palFX.sinAdd = -255, -255, -255, 48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 1200, Second Attack]
type = ChangeState
trigger1 = movehit&&animelemtime(6)>=0
value = 3160
ignoreHitPause=0

[State 3100, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(6)=0
movetype=I

[State 3100, Gravity]
type=Gravity
trigger1=AnimElemTime(6)>=0

[State 3100, Change]
type=ChangeState
trigger1=Pos y>-Vel y
value=3104
;----------------------------------------------------------------------
;Max S Vorpal 2nd Attack
[Statedef 3160]
type = A
movetype = A
physics = N
ctrl = 0
anim=3160
velset = 0,0
poweradd = 0
sprpriority = 1
facep2 = 1

[State 3160, Voice]
type = PlaySnd
trigger1 = AnimElem=3
value = 100,2
channel = 5

[State 3160, Voice]
type = PlaySnd
trigger1 = AnimElem=11
value = 1100,3
channel = 0
[State 3160, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=11
value = 1,9
channel=1

[State 3160, VelAdd]
type=VelAdd
trigger1 =animelemtime(11)>0
y=.55

[State 3160, VelSet]
type = VelSet
trigger1 =animelem=3
x = 8.25
y = .5

[State 3160, Aero FX]
type = helper
trigger1 = animelemtime(11)=0
helpertype = normal
stateno = 665
ID = 665
name = "Vorpal2ndFX"
postype = p1
pos = 0,0
ownpal = 1
[State 3160, Helper]
type = Helper
triggerall = !numhelper(7000)
trigger1 =animelem=3
helpertype = normal ;player
name ="Light"
ID =7000
stateno =7000
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=0

[State 3160, Hit]
type=HitDef
trigger1=AnimElem=11
attr=A, HA
damage=100, 20
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=35, 35
guardflag=HA
hitflag=MAF
hitsound = S2+10*var(44),14
guardsound=S130,2
pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
guard.pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) := 100), var(36) := -28
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=6
ground.hittime =12
guard.hittime=12
ground.velocity=-9,9
air.velocity=-9,9
guard.velocity=Ifelse(var(20),-3,-6)
airguard.velocity =Ifelse(var(20),-3,-6), -2
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=.5
fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3160, Change]
type=ChangeState
trigger1=Pos y>-Vel y
value=3164
;------------------------------------------------------------------
; Land
[Statedef 3164]
type=S
movetype=I
physics =S
anim=3104
ctrl=0
velset=0,0

[State 1104, PosSet]
type=PosSet
trigger1 =1
y=0
[State 1104, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 1104, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 1104, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;------------------------------------------------------------------
; Super Sword Rush
[Statedef 3200]
type=S
movetype=A
physics=N
anim=3200
poweradd=-1000
ctrl=0
velset=0,0
sprpriority=1
facep2=1

[State 3200, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3200, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3200, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3200, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3200, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3200, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3200, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8500
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-25*const(size.xscale)), ceil(-207*const(size.yscale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3200, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,0
darken=0
poweradd=0

[State 3200, Voice]
type = PlaySnd
trigger1 = AnimElem =1
value = 731,0
channel = 0
[State 3200, Voice]
type = PlaySnd
trigger1 = AnimElem =3
value = 0,23
channel = 0
[State 3200, Swing Snd]
type = PlaySnd
trigger1 = Animelem =3
value = 1,2
channel=1

[State 3200, VelSet]
type = VelSet
trigger1 =Animelem =3
x = 14

[State 3200, Dust Helper]
type = Helper
trigger1 = Animelem =3
helperType = Normal
stateNo = 8103
ID = 8100
name = "Dash Dust"
posType = P1
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1
[State 3200, Starting Step snd]
type = PlaySnd
trigger1 = Animelem =3
value = 100, 2
channel = 5

[State 3200, HitDef]
type = HitDef
attr = S, HA
trigger1 = AnimElem=3
animtype = Hard
damage = 62,10
getpower=0,0
givepower=18, 18
priority=4, hit
guardflag = MA
pausetime = 12,12
sparkNo = -1 + 0 * (var(33) := 8014)
sparkXY = -10 + 0 * (var(35) := 51), var(36) := -40
guard.sparkNo = -1 + 0 * (var(34) := 8001)
hitsound=S2+10*var(44),2
guardsound = s130, 0
ground.type = high
ground.slidetime = 17
ground.hittime  = 17
guard.hittime = 14
ground.velocity=Ifelse(var(20),-2.5,-4),Ifelse(var(20),-5.5,-6.5)
guard.velocity=Ifelse(var(20),-2.5,-7)
air.velocity = Ifelse(var(20),-2.5,-4),Ifelse(var(20),-3.5,-6.5)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
air.fall = 1
yaccel = .49
palFX.time = 12 * var(9)
palFX.add = 255, 255, 255
palFX.sinAdd = -255, -255, -255, 48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3200, Second Attack]
type = ChangeState
triggerall = movehit
trigger1 = animelemtime(7)>=0
trigger2 = p2bodydist x<=50
value = 3210
ignoreHitPause=0

[State 3200, VelMul]
type = VelMul
trigger1 =AnimElem = 7, >= 0
x = .75

[State 3200, Skid Snd]
type = PlaySnd
trigger1 = AnimElem = 7
value = 101,0
[State 3200, Skid Dust]
type = Explod
trigger1 = AnimElem = 7
anim = 8104
sprPriority=3
posType = P1
pos = 30,3
vel = 0,0
scale = 0.5,0.5
pauseMovetime = -1
superMoveTime = -1
ownpal = 1

[State 3200, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(7) = 0
moveType=I

[State 3200, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1
;------------------------------------------------------------------
;Second Attack
[Statedef 3210]
type=S
movetype=A
physics=N
ctrl=0
anim=3210
velset=8,0
poweradd=0
sprpriority=1
facep2=1

[State 3210, Voice]
type=PlaySnd
trigger1 =animelem=4
value=1200,1
channel=0
[State 3210, SND]
type=PlaySnd
trigger1 =animelem=4
value=1,7
channel=1
[State 3210, Up Snd]
type=PlaySnd
trigger1=Animelem=3
value=41,0
[State 3210, Dust Helper]
type=Helper
trigger1=animelem=3
helperType=Normal
stateNo=8100
ID=8100
name="Jump Dust"
posType=P1
ownPal=1
pos = 0,0

[State 3210, Rush FX]
type = helper
trigger1 = animelemtime(4)=0
helpertype = normal
stateno = 1215
ID = 1215
name = "SwordRushFX"
postype = p1
pos = 0,0
ownpal = 1

[State 3210, StateTypeSet]
type=StateTypeSet
trigger1=animelem=3
statetype=A
[State 3210, VelSet]
type=VelSet
trigger1 =animelem=3
x=7
y=-9
[State 3210, VelMul]
type = VelAdd
trigger1 =animelemtime(3)>0&&animelemtime(6)<0
x = -.4
[State 3210, VelAdd]
type=VelAdd
trigger1 =animelemtime(5)>=0
y=Ifelse(var(20),.65,.55)
[State 3210, Hit]
type=HitDef
trigger1=animelem=4
attr=A, HA
damage=62,10
priority=4, hit
animtype=Hard
getpower=0,0
givepower=18, 18
guardflag=MA
hitflag=MAF
hitsound = S2+10*var(44),14
guardsound=S130,2
pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
guard.pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=50), var(36) :=Ifelse((P2BodyDist Y)>-136,-55+Ceil(P2BodyDist Y),-136)
air.animtype=Up
fall.animtype=Back
ground.type=Low
air.type=Low
ground.slidetime=18
ground.hittime =18
guard.hittime=18
ground.velocity=Ifelse(var(20),-2,-4),-8
air.velocity=Ifelse(var(20),-2,-4),-8
guard.velocity=Ifelse(var(20),-3,-5)
airguard.velocity=Ifelse(var(20),-2.5,-5), -3
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
fall=1
yaccel=Ifelse(var(20),.4,.5)
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=8
envshake.ampl=3
envShake.freq=120

[State 3220, PlayerPush]
type = PlayerPush
trigger1=!animtime
trigger2=Pos y>-Vel y
value = 0
ignorehitpause =1
[State 3220, PosSet]
type=PosAdd
trigger1=!animtime
trigger2=Pos y>-Vel y
x=140
[State 3210, Change]
type=ChangeState
trigger1=!animtime
trigger2=Pos y>-Vel y
value=3220
;------------------------------------------------------------------
; Third Attack
[Statedef 3220]
type=S
movetype=A
physics =S
anim=3220
ctrl=0
velset=0,0

[State 3220, PosSet]
type=PosSet
trigger1 =1
y=0
[State 3220, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 3220, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 3220, Rush FX]
type = helper
trigger1 = !time
helpertype = normal
stateno = 3225
ID = 3225
name = "SwordRushFX"
postype = p1
pos = 0,0
ownpal = 1

[State 3220, Voice]
type=PlaySnd
trigger1 =animelem=1
value=1200,2
channel=0
[State 3220, SND]
type=PlaySnd
trigger1 =animelem=1
value=1,7
channel=1
[State 3220, hitsnd]
type=playsnd
trigger1= movecontact && numtarget
trigger1= !(target,time) && target,movetype=H
value=ifelse(moveguarded,130,2+10*var(44)),ifelse(moveguarded,2,14)
channel=2
persistent=0
ignorehitpause=1

[State 3220, Snd Position]
type = SndPan
trigger1 = 1
channel = 1
pan = 0
ignoreHitPause = 1
[State 3220, Hit/Guard Snd Position]
type = SndPan
trigger1 = 1
channel = 2
pan = 0
ignoreHitPause = 1

[State 3220, Hit]
type=HitDef
trigger1=!time
attr=S, HA
damage=66, 14
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=35, 35
guardflag=HA
hitflag=MAF
hitsound = -1
guardsound=-1
pauseTime=12,12
guard.pauseTime=12,12
sparkNo=-1 + 0 * (var(33) :=0)
guard.sparkNo=-1 + 0 * (var(34) :=0)
sparkXY=-10 + 0 * (var(35) := 100), var(36) := -28
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=6
ground.hittime =12
guard.hittime=12
ground.velocity=0,9
air.velocity=0,9
guard.velocity=Ifelse(var(20),-2,-3)
airguard.velocity =Ifelse(var(20),-2,-3), 4
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=.5
fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3220, HitSpark]
type=Helper
trigger1= movecontact && numtarget
trigger1= (target,movetype=H) && !(target,time)
helperType=Normal
stateNo=ifElse(MoveGuarded, 8001, 8015)
ID=8000
name="Spark"
pos= ceil(p2dist x),ceil(p2dist y-55)
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1
persistent=0

[State 3220, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(3)=0
movetype=I

[State 3220, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;------------------------------------------------------------------
; Max Super Sword Rush
[Statedef 3250]
type=S
movetype=A
physics=N
anim=3200
poweradd=-2000
ctrl=0
velset=0,0
sprpriority=1
facep2=1

[State 3200, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3200, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3200, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3200, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3200, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3200, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3200, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8510
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-25*const(size.xscale)), ceil(-207*const(size.yscale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3200, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,1
darken=0
poweradd=0

[State 3200, Voice]
type = PlaySnd
trigger1 = AnimElem =1
value = 731,0
channel = 0
[State 3200, Voice]
type = PlaySnd
trigger1 = AnimElem =3
value = 0,23
channel = 0
[State 3200, Swing Snd]
type = PlaySnd
trigger1 = Animelem =3
value = 1,2
channel=1

[State 3200, VelSet]
type = VelSet
trigger1 =Animelem =3
x = 18

[State 3200, Dust Helper]
type = Helper
trigger1 = Animelem =3
helperType = Normal
stateNo = 8103
ID = 8100
name = "Dash Dust"
posType = P1
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1
[State 3200, Starting Step snd]
type = PlaySnd
trigger1 = Animelem =3
value = 100, 2
channel = 5

[State 3200, HitDef]
type = HitDef
attr = S, HA
trigger1 = !Time
animtype = Hard
damage = 62,10
getpower=0,0
givepower=18, 18
priority=4, hit
guardflag = MA
pausetime = 12,12
sparkNo = -1 + 0 * (var(33) := 8014)
sparkXY = -10 + 0 * (var(35) := 51), var(36) := -40
guard.sparkNo = -1 + 0 * (var(34) := 8001)
hitsound=S2+10*var(44),2
guardsound = s130, 0
ground.type = high
ground.slidetime = 17
ground.hittime  = 17
guard.hittime = 14
ground.velocity=Ifelse(var(20),-2.5,-4),Ifelse(var(20),-5.5,-6.5)
guard.velocity=Ifelse(var(20),-2.5,-7)
air.velocity = Ifelse(var(20),-2.5,-4),Ifelse(var(20),-3.5,-6.5)
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
air.fall = 1
yaccel = .49
palFX.time = 12 * var(9)
palFX.add = 255, 255, 255
palFX.sinAdd = -255, -255, -255, 48
envshake.time=14
envshake.ampl=4
envShake.freq=120

[State 3200, Second Attack]
type = ChangeState
triggerall = movehit
trigger1 = animelemtime(7)>=0
trigger2 = p2bodydist x<=50
value = 3260
ignoreHitPause=0

[State 3200, VelMul]
type = VelMul
trigger1 =AnimElem = 7, >= 0
x = .75

[State 3200, Skid Snd]
type = PlaySnd
trigger1 = AnimElem = 7
value = 101,0
[State 3200, Skid Dust]
type = Explod
trigger1 = AnimElem = 7
anim = 8104
sprPriority=3
posType = P1
pos = 30,3
vel = 0,0
scale = 0.5,0.5
pauseMovetime = -1
superMoveTime = -1
ownpal = 1

[State 3200, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(7) = 0
moveType=I

[State 3200, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1
;------------------------------------------------------------------
;Second Attack
[Statedef 3260]
type=S
movetype=A
physics=N
ctrl=0
anim=3210
velset=8,0
poweradd=0
sprpriority=1
facep2=1

[State 3210, Voice]
type=PlaySnd
trigger1 =animelem=4
value=1200,1
channel=0
[State 3210, SND]
type=PlaySnd
trigger1 =animelem=4
value=1,7
channel=1
[State 3210, Up Snd]
type=PlaySnd
trigger1=Animelem=3
value=41,0
[State 3210, Dust Helper]
type=Helper
trigger1=animelem=3
helperType=Normal
stateNo=8100
ID=8100
name="Jump Dust"
posType=P1
ownPal=1
pos = 0,0

[State 3210, Rush FX]
type = helper
trigger1 = animelemtime(4)=0
helpertype = normal
stateno = 1215
ID = 1215
name = "SwordRushFX"
postype = p1
pos = 0,0
ownpal = 1

[State 3210, StateTypeSet]
type=StateTypeSet
trigger1=animelem=3
statetype=A
[State 3210, VelSet]
type=VelSet
trigger1 =animelem=3
x=7
y=-9
[State 3210, VelMul]
type = VelAdd
trigger1 =animelemtime(3)>0&&animelemtime(6)<0
x = -.4
[State 3210, VelAdd]
type=VelAdd
trigger1 =animelemtime(5)>=0
y=Ifelse(var(20),.65,.55)
[State 3210, Hit]
type=HitDef
trigger1=animelem=4
attr=A, HA
damage=62,10
priority=4, hit
animtype=Hard
getpower=0,0
givepower=18, 18
guardflag=MA
hitflag=MAF
hitsound = S2+10*var(44),14
guardsound=S130,2
pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
guard.pauseTime=ifElse(var(20), 6, 12), ifElse(var(20), 6, 12)
sparkNo=-1 + 0 * (var(33) :=8024)
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=50), var(36) :=Ifelse((P2BodyDist Y)>-136,-55+Ceil(P2BodyDist Y),-136)
air.animtype=Up
fall.animtype=Back
ground.type=Low
air.type=Low
ground.slidetime=18
ground.hittime =18
guard.hittime=18
ground.velocity=Ifelse(var(20),-2,-4),-8
air.velocity=Ifelse(var(20),-2,-4),-8
guard.velocity=Ifelse(var(20),-3,-5)
airguard.velocity=Ifelse(var(20),-2.5,-5), -3
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
fall=1
yaccel=Ifelse(var(20),.4,.5)
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=8
envshake.ampl=3
envShake.freq=120

[State 3220, PlayerPush]
type = PlayerPush
trigger1=!animtime
trigger2=Pos y>-Vel y
value = 0
ignorehitpause =1
[State 3220, PosSet]
type=PosAdd
trigger1=!animtime
trigger2=Pos y>-Vel y
x=140
[State 3210, Change]
type=ChangeState
trigger1=!animtime
trigger2=Pos y>-Vel y
value=3270
;------------------------------------------------------------------
; Third Attack
[Statedef 3270]
type=S
movetype=A
physics =S
anim=3220
ctrl=0
velset=0,0

[State 3220, PosSet]
type=PosSet
trigger1 =1
y=0
[State 3220, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 3220, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 3220, Rush FX]
type = helper
trigger1 = !time
helpertype = normal
stateno = 3225
ID = 3225
name = "SwordRushFX"
postype = p1
pos = 0,0
ownpal = 1

[State 3220, Voice]
type=PlaySnd
trigger1 =animelem=1
value=1200,2
channel=0
[State 3220, SND]
type=PlaySnd
trigger1 =animelem=1
value=1,7
channel=1
[State 3220, hitsnd]
type=playsnd
trigger1= movecontact && numtarget
trigger1= !(target,time) && target,movetype=H
value=ifelse(moveguarded,130,2+10*var(44)),ifelse(moveguarded,2,14)
channel=2
persistent=0
ignorehitpause=1

[State 3220, Snd Position]
type = SndPan
trigger1 = 1
channel = 1
pan = 0
ignoreHitPause = 1
[State 3220, Hit/Guard Snd Position]
type = SndPan
trigger1 = 1
channel = 2
pan = 0
ignoreHitPause = 1

[State 3220, Hit]
type=HitDef
trigger1=!time
attr=S, HA
damage=66, 14
priority=4, hit
animtype=Hard
getpower=0, 0
givepower=35, 35
guardflag=HA
hitflag=MAF
hitsound = -1
guardsound=-1
pauseTime=0,12
guard.pauseTime=12,12
sparkNo=-1 + 0 * (var(33) :=0)
guard.sparkNo=-1 + 0 * (var(34) :=0)
sparkXY=-10 + 0 * (var(35) := 100), var(36) := -28
air.animtype=Back
fall.animtype=Back
ground.type=High
air.type=Low
ground.slidetime=6
ground.hittime =12
guard.hittime=12
ground.velocity=-3,9
air.velocity=-3,9
guard.velocity=Ifelse(var(20),-2,-3)
airguard.velocity =Ifelse(var(20),-2,-3), 4
airguard.ctrlTime=12
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=.5
fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
envshake.time=14
envshake.ampl=4
envShake.freq=120
id=3250

[State 3220, HitSpark]
type=Helper
trigger1= movecontact && numtarget
trigger1= (target,movetype=H) && !(target,time)
helperType=Normal
stateNo=ifElse(MoveGuarded, 8001, 8015)
ID=8000
name="Spark"
pos= ceil(p2dist x),ceil(p2dist y-55)
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1
persistent=0

[State 3260, p2state]
type=targetstate
trigger1= movehit && numtarget(3250)
trigger1= target(3250),Movetype=H
ID=3250
value=3280
ignorehitpause=1
[State 3260, p1state]
type=changestate
trigger1= movehit && numtarget(3250)
trigger1= target(3250),Movetype=H
value=3271
ignorehitpause=1

[State 3220, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(3)=0
movetype=I

[State 3220, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;------------------------------------------------------------------
; Third Attack - Success
[Statedef 3271]
type=S
movetype=A
physics =S
anim=3270
ctrl=0
velset=0,0

[State 3271, p2state]
type=targetstate
trigger1= !time
trigger1= numtarget(3250)
ID=3250
value=3280
ignorehitpause=1

[State 3271, PlayerPush]
type = PlayerPush
trigger1 = animelemtime(3)<0
value = 0
ignorehitpause =1

[State 3271, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA
ignorehitpause =1

[State 3220, PosSet]
type=PosSet
trigger1 =1
y=0
[State 3220, SND]
type=PlaySnd
triggerall= numtarget
trigger1 =animelemtime(2)=15
trigger2 =animelemtime(2)=20
trigger3 =animelemtime(2)=25
trigger4 =animelemtime(2)=30
value=2+10*var(44),14
channel=2

[State 3220, HitSpark]
type=Helper
triggerall= numtarget
trigger1 =animelemtime(2)=15
trigger2 =animelemtime(2)=20
trigger3 =animelemtime(2)=25
trigger4 =animelemtime(2)=30
helperType=Normal
stateNo=ifElse(MoveGuarded, 8001, 8015)
ID=8000
name="Spark"
pos= ceil(p2dist x),ceil(p2dist y-55)
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1

[State 3220, EnvShake]
type = EnvShake
triggerall = NumTarget
trigger1 =animelemtime(2)=15
trigger2 =animelemtime(2)=20
trigger3 =animelemtime(2)=25
trigger4 =animelemtime(2)=30
time = 14
freq = 120
ampl = 4

[State 3220, HitAdd]
type = HitAdd
triggerall = NumTarget
trigger1 =animelemtime(2)=15
trigger2 =animelemtime(2)=20
trigger3 =animelemtime(2)=25
trigger4 =animelemtime(2)=30
value = 1

[State 3220, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget
trigger1 =animelemtime(2)=15
trigger2 =animelemtime(2)=20
trigger3 =animelemtime(2)=25
value =floor(-26*fvar(10))
kill = 0

[State 3220, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget
trigger1 =animelemtime(2)=30
value =floor(-26*fvar(10))
kill = 1

[State 3220, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(3)=0
movetype=I

[State 3220, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;---------------------------------------------------------------------------
;P2 Fall
[Statedef 3280]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = -4

[State 3301, PlayerPush]
type = PlayerPush
trigger1 = Time<42
value = 0
ignorehitpause =1

[State 3320, NotHitBy]
type = NotHitBy
trigger1 =Time<42
value = SCA
ignorehitpause =1

[State 3320, Anim]
type=changeanim
trigger1= time<42
value=5050
[State 3320, VelSet]
type = VelSet
trigger1 = time=42
x = 0
y = 9

[State 3320, VelAdd]
type = VelAdd
Trigger1 = time>=42
y = .55

[State 3320, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3320, SelfState]
type = SelfState
trigger1 = Time>=42&&Pos Y >= 0&&Vel Y > 0
value = 5100
;------------------------------------------------------------------
;OSS Mother's Rosario
[Statedef 3300]
type=S
movetype=A
physics=N
anim=3300
poweradd=-3000
ctrl=0
velset=0,0
sprpriority=1
facep2=1

[State 3300, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3300, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3400, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3300, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3300, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3300, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3300, SuperPause FX]
type=Helper
trigger1=animelem=3
helperType=Normal
stateNo=8520
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(73 * const(size.xScale)), ceil(-208 * const(size.yScale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3300, SuperPause]
type=SuperPause
trigger1=!time
time=6
moveTime=6
p2DefMul=1
unHittable=1
anim=-1
darken=0
poweradd=0
[State 3300, SuperPause]
type=SuperPause
trigger1=animelem=3
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,2
darken=0
poweradd=0

[State 3300,BlackBG]
type=helper
trigger1 =animelem=3
helpertype=normal
stateno=3480
ID=3480
name="BlackBG"
postype=Back
supermovetime=99999
pausemovetime=99999
ownpal=1
ignorehitpause=1
size.xScale=5
size.yScale=5

[State 3300, Voice]
type=PlaySnd
trigger1 =!time
value=3300,0+1*((numenemy) && (enemy, name = "Asuna" || enemy, name = "Asuna Yuuki" || enemy, name = "Asuna_Yuuki" || enemy, name = "Asuna_K"))
channel=0

[State 3400, Voice]
type=PlaySnd
trigger1 =animelem=16
value=1,8
channel=1

[State 3300, NotHitBy]
type=NotHitBy
trigger1=AnimElemTime(16) < 0
time=1
value=SCA
ignoreHitPause=1

[State 3300, width]
type = width
trigger1 = animelemtime(15)>=0
edge = 72, 0
[State 3300, Bind 1]
type=null;targetbind
trigger1= movehit=1&&numtarget(3300)
pos=72, 0
ignoreHitPause=1

[State 3300, Helper]
type = Helper
trigger1=animelem=16
helpertype = normal
name = "Mothers FX"
ID = 3305
stateno = 320
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1

[State 3300, HitDef]
type = HitDef
attr = S, HA
trigger1 = AnimElem=16
animtype = Hard
damage = 75,25
getpower=0, 0
givepower=22, 22
priority=4, hit
guardflag = MA
pausetime = 0,0
guard.pausetime = 10,10
sparkNo = -1 + 0 * (var(33) := 0)
sparkXY = -10 + 0 * (var(35) := 145), var(36) := -42
guard.sparkNo = -1 + 0 * (var(34) := 8001)
;hitsound=S2+10*var(44),14
guardsound = s130, 2
air.animtype = Up
fall.animtype = Up
ground.type = Low
air.type = Low
ground.slidetime = 20
ground.hittime  = 20
guard.hittime = 20
ground.velocity=0,-9
guard.velocity=Ifelse(var(20),-2.5,-7)
air.velocity = 0,-9
airguard.velocity = -7,3
ground.cornerpush.veloff = 0
guard.cornerpush.veloff = 0
air.cornerpush.veloff = 0
airguard.cornerpush.veloff = 0
fall = 1
fall.recover = 0
air.fall = 1
yaccel = .35
palFX.time = 12 * var(9)
palFX.add = 255, 255, 255
palFX.sinAdd = -255, -255, -255, 48
envshake.time=14
envshake.ampl=4
envShake.freq=120
id=3300
kill=0
guard.kill=0
p2facing=1

[State 3300, NotHitBy]
type=NotHitBy
trigger1=movehit&&numtarget(3300)
time=1
value=SCA
ignoreHitPause=1

[State 3300, p2state]
type=targetstate
trigger1= movehit && numtarget(3300)
trigger1= target(3300),Movetype=H
ID=3300
value=ifelse((facing=1),3320,3325)
ignorehitpause=1
persistent=0
[State 3300, p1state]
type=changestate
trigger1= movehit && numtarget(3300)
trigger1= target(3300),Movetype=H
value=3310
ignorehitpause=1
persistent=0

[State 3300, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(17) = 0
moveType=I

[State 3300, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;----------------------------------------------------------------------
;Mother's Rosario Second Attack
[Statedef 3310]
type = S
movetype = A
physics = N
ctrl = 0
anim=3310
velset = 0,0
poweradd = 0
sprpriority = 2
facep2 = 1

[State 3310, Explod]
type = Explod
trigger1 = time = 0
anim =8550
ID = 3350
pos = 0,0
postype = back
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime =-1
supermovetime = 9999
pausemovetime = 9999
scale = 1.2,1.2
sprpriority = 999
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 1
ignorehitpause = 1
;persistent =

[State 3310, ModifyExplod]
type = ModifyExplod
trigger1 = time>=1  && time<=12
ID = 3350
trans = addalpha
alpha=256-((time)*20),256
ignorehitpause = 1

[State 3312, RemoveExplod]
type=removeexplod
trigger1= time>=13
ID = 3350

[State 3310, PosSet]
type=PosSet
trigger1 =1
x=0
ignorehitpause =1

[State 3310, Up Snd]
type=PlaySnd
trigger1=Animelem=5
value=41,0
ignorehitpause =1
[State 3310, Dust Helper]
type = Helper
trigger1 = Animelem =5
helperType = Normal
stateNo = 8100
ID = 8100
name = "Jump Dust"
posType = P1
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1
ignorehitpause =1

[State 3310, StateTypeSet]
type=StateTypeSet
trigger1=animelem=5
statetype=A
ignorehitpause =1

[State 3310, Voice]
type = PlaySnd
trigger1 = AnimElem=5
value = 3300,2+1*((numenemy) && (enemy, name = "Asuna" || enemy, name = "Asuna Yuuki" || enemy, name = "Asuna_Yuuki" || enemy, name = "Asuna_K"))
channel = 0
[State 3310, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=6
value = 1,9
channel=1

[State 3310, VelSet]
type=VelSet
trigger1 =animelem=5
y=-11
ignorehitpause =1

[State 3310, VelSet]
type = VelSet
trigger1 =animelemtime(6)=0
y = 1

[State 3310, VelAdd]
type=VelAdd
trigger1 =animelemtime(5)>0&&animelemtime(6)<0
trigger2 =animelemtime(6)>20
y=.55

[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(6)=0
helpertype = normal
stateno = 3305
ID = 3305
name = "Mothers FX"
postype = p1
pos = ceil(0 * const(size.yScale)), ceil(-175 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(6)=5
helpertype = normal
stateno = 3307
ID = 3320
name = "Mothers FX"
postype = p1
pos = ceil(250 * const(size.yScale)), ceil(-145 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(6)=10
helpertype = normal
stateno = 3307
ID = 3320
name = "Mothers FX"
postype = p1
pos = ceil(-250 * const(size.yScale)), ceil(-145 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(6)=15
helpertype = normal
stateno = 3307
ID = 3321
name = "Mothers FX"
postype = p1
pos = ceil(450 * const(size.yScale)), ceil(-145 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(6)=20
helpertype = normal
stateno = 3307
ID = 3322
name = "Mothers FX"
postype = p1
pos = ceil(-450 * const(size.yScale)), ceil(-145 * const(size.yScale))
ownpal = 1

[State 3300, p2state]
type=targetstate
trigger1= numtarget(3300)
trigger1= animelemtime(6)=0|animelemtime(6)=5|animelemtime(6)=10|animelemtime(6)=15|animelemtime(6)=20
ID=3300
value=3321
ignorehitpause=1

[State 3300, Bind 1]
type=targetbind
trigger1= numtarget(3300)&&animelemtime(6)>=0&&animelemtime(6)<=20
pos=ceil(146 * const(size.yScale)), ceil(47 * const(size.yScale))
ignoreHitPause=1

[State 3310, HitSpark]
type=Helper
triggerall=NumTarget
trigger1 =animelemtime(1)=0
helperType=Normal
stateNo=8015
ID=8000
name="Spark"
posType=P1
pos=72, -42
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1

[State 3310, Hit Snd]
type = PlaySnd
triggerall = NumTarget
trigger1=animelemtime(1)=0
value = 2+10*var(44),14
channel=2

[State 3310, HitSpark]
type=Helper
triggerall=NumTarget
trigger1 =animelemtime(6)=0|animelemtime(6)=5|animelemtime(6)=10|animelemtime(6)=15|animelemtime(6)=20
helperType=Normal
stateNo=8015
ID=8000
name="Spark"
posType=P1
pos=ceil(146 * const(size.yScale)), ceil(47 * const(size.yScale))
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1
[State 3310, Hit Snd]
type = PlaySnd
triggerall = NumTarget
trigger1=animelemtime(6)=0|animelemtime(6)=5|animelemtime(6)=10|animelemtime(6)=15|animelemtime(6)=20
value = 2+10*var(44),14
channel=2

[State 3310, EnvShake]
type = EnvShake
triggerall = NumTarget
trigger1=animelemtime(6)=0|animelemtime(6)=5|animelemtime(6)=10|animelemtime(6)=15|animelemtime(6)=20
time = 14
freq = 120
ampl = 4

[State 3310, HitAdd]
type = HitAdd
triggerall = NumTarget
trigger1=animelemtime(6)=0|animelemtime(6)=5|animelemtime(6)=10|animelemtime(6)=15|animelemtime(6)=20
value = 1

[State 3310, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget
trigger1=animelemtime(6)=0|animelemtime(6)=5|animelemtime(6)=10|animelemtime(6)=15|animelemtime(6)=20
value =floor(-26*fvar(10))
kill = 0

[State 3300, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3310, Change]
type=ChangeState
trigger1=Time>0&&Pos y>-Vel y
value=3311
;----------------------------------------------------------------------
;Mother's Rosario Third Attack
[Statedef 3311]
type = S
movetype = A
physics = N
ctrl = 0
anim=3311
velset = 0,0
poweradd = 0
sprpriority = 2
facep2 = 0

[State 3310, PosSet]
type=PosSet
trigger1 =1
x=0
ignorehitpause =1

[State 3311, PosSet]
type=PosSet
trigger1 =!Time
y=0
[State 3311, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 3311, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 3310, Up Snd]
type=PlaySnd
trigger1=Animelem=2
value=41,0
[State 3310, Dust Helper]
type = null;Helper
trigger1 = Animelem =2
helperType = Normal
stateNo = 8100
ID = 8100
name = "Jump Dust"
posType = P1
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1
pos = -40,0

[State 3310, StateTypeSet]
type=StateTypeSet
trigger1=animelem=2
statetype=A

[State 3310, Swing Snd]
type = PlaySnd
trigger1 = AnimElem=2
value = 1,9
channel=1

[State 3310, VelSet]
type = VelSet
trigger1 =animelem=2
y = -1

[State 3310, VelSet]
type = VelSet
trigger1 =animelem=3
y = -3

[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(2)=0
helpertype = normal
stateno = 3305
ID = 3305
name = "Mothers FX"
postype = p1
pos = ceil(0 * const(size.yScale)), ceil(-235 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(2)=5
helpertype = normal
stateno = 3307
ID = 3320
name = "Mothers FX"
postype = p1
pos = ceil(250 * const(size.yScale)), ceil(-205 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(2)=10
helpertype = normal
stateno = 3307
ID = 3320
name = "Mothers FX"
postype = p1
pos = ceil(-250 * const(size.yScale)), ceil(-205 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(2)=15
helpertype = normal
stateno = 3307
ID = 3321
name = "Mothers FX"
postype = p1
pos = ceil(450 * const(size.yScale)), ceil(-205 * const(size.yScale))
ownpal = 1
[State 3310, Mothers FX]
type = helper
trigger1 = animelemtime(2)=20
helpertype = normal
stateno = 3307
ID = 3322
name = "Mothers FX"
postype = p1
pos = ceil(-450 * const(size.yScale)), ceil(-205 * const(size.yScale))
ownpal = 1

[State 3300, p2state]
type=targetstate
trigger1= numtarget(3300)
trigger1= animelemtime(2)=0|animelemtime(2)=5|animelemtime(2)=10|animelemtime(2)=15|animelemtime(2)=20
ID=3300
value=3323
ignorehitpause=1

[State 3300, Bind 1]
type=targetbind
trigger1= numtarget(3300)&&animelemtime(2)>=0&&animelemtime(3)<0
pos=ceil(240 * const(size.yScale)), ceil(-340 * const(size.yScale))
ignoreHitPause=1

[State 3310, HitSpark]
type=Helper
triggerall=NumTarget
trigger1 =animelemtime(2)=0|animelemtime(2)=5|animelemtime(2)=10|animelemtime(2)=15|animelemtime(2)=20
helperType=Normal
stateNo=8015
ID=8000
name="Spark"
posType=P1
pos=ceil(240 * const(size.yScale)), ceil(-340 * const(size.yScale))
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1
[State 3310, Hit Snd]
type = PlaySnd
triggerall = NumTarget
trigger1=animelemtime(2)=0|animelemtime(2)=5|animelemtime(2)=10|animelemtime(2)=15|animelemtime(2)=20
value = 2+10*var(44),14
channel=2

[State 3310, EnvShake]
type = EnvShake
triggerall = NumTarget
trigger1=animelemtime(2)=0|animelemtime(2)=5|animelemtime(2)=10|animelemtime(2)=15|animelemtime(2)=20
time = 14
freq = 120
ampl = 4

[State 3310, HitAdd]
type = HitAdd
triggerall = NumTarget
trigger1=animelemtime(2)=0|animelemtime(2)=5|animelemtime(2)=10|animelemtime(2)=15|animelemtime(2)=20
value = 1

[State 3310, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget
trigger1=animelemtime(2)=0|animelemtime(2)=5|animelemtime(2)=10|animelemtime(2)=15|animelemtime(2)=20
value =floor(-26*fvar(10))
kill = 0

[State 3300, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3310, Change]
type=ChangeState
trigger1=!animtime
value=3312
;------------------------------------------------------------------
;Mother's Rosario Final Attack
[Statedef 3312]
type=A
movetype=A
physics=N
anim=3312
ctrl=0
;velset=0,0
sprpriority=2
facep2=1

[State 3310, PosSet]
type=PosSet
trigger1 =animelemtime(6)<0
x=0
ignorehitpause =1

[State 3310, VelSet]
type = VelMul
trigger1 =animelemtime(4)<0
y = .9

[State 3310, Helper]
type = Helper
triggerall = !numhelper(7000)
trigger1 =animelem=1
helpertype = normal ;player
name ="Light"
ID =7000
stateno =7000
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=0

[State 3300, SuperPause FX]
type=Helper
trigger1=time=40
helperType=Normal
stateNo=3330
ID=3330
name="Superpause FX"
posType=P1
pos=ceil(-144 * const(size.xScale)), ceil(-342 * const(size.yScale))
superMoveTime=0
size.xScale=1
size.yScale=1
ownPal=1

[State 3300, Charge Snd]
type = PlaySnd
trigger1 = Animelem =1
value = 3301,0
channel=6

[State 3300, Voice]
type = PlaySnd
trigger1 = AnimElem =4
value = 3300,4
channel = 0
[State 3300, Swing Snd]
type = PlaySnd
trigger1 = Animelem =4
value = 1,9
channel=1

[State 3300, Hit Snd 1]
type = PlaySnd
trigger1 = Animelem =4
value = 2+10*var(44),14
channel=2
[State 3300, Hit Snd 2]
type = PlaySnd
trigger1 = Animelem =4
value = 3301,1
channel=6
[State 3300, Hit Snd 3]
type = PlaySnd
trigger1 = Animelem =4
value = 3301,2

[State 3300, VelSet]
type = PosAdd
trigger1 =Animelem = 6
y = -60

[State 3300, VelSet]
type = VelSet
trigger1 =Animelem = 6
x = -3
y = -6

[State 3310, Mothers FX]
type = helper
trigger1 = animelem=4
helpertype = normal
stateno = 3308
ID = 3308
name = "Mothers Finish FX"
postype = p1
pos = ceil(200 * const(size.xScale)), ceil(-125 * const(size.yScale))
ownpal = 1
ignorehitpause = 1
persistent=0
[State 3310, Mothers FX]
type = helper
trigger1 = animelem=4
helpertype = normal
stateno = 3308
ID = 3309
name = "Mothers Finish FX"
postype = p1
pos = ceil(200 * const(size.xScale)), ceil(-125 * const(size.yScale))
ownpal = 1
ignorehitpause = 1
persistent=0

[State 3310, Mothers FX]
type = helper
trigger1 = animelem=4
helpertype = normal
stateno = 3335
ID = 3335
name = "Mothers Finish FX 2"
postype = p1
pos = ceil(239 * const(size.yScale)), ceil(-92 * const(size.yScale))
ownpal = 1
size.xScale=.75
size.yScale=.75
ignorehitpause = 1
persistent=0
[State 3310, Mothers FX]
type = helper
trigger1 = animelem=4
helpertype = normal
stateno = 3335
ID = 3336
name = "Mothers Finish FX 2"
postype = p1
pos = ceil(239 * const(size.yScale)), ceil(-92 * const(size.yScale))
ownpal = 1
size.xScale=.75
size.yScale=.75
ignorehitpause = 1
persistent=0

[State 3310, Mothers FX]
type = helper
trigger1 = animelem=4
helpertype = normal
stateno = 3337
ID = 3337
name = "Mothers Finish FX 3"
postype = p1
pos = ceil(239 * const(size.yScale)), ceil(-92 * const(size.yScale))
ownpal = 1
ignorehitpause = 1
persistent=0

[State 3300, NotHitBy]
type=NotHitBy
trigger1=1
time=1
value=SCA

[State 3300, p2state]
type=targetstate
trigger1= numtarget(3300)
trigger1= animelemtime(4)=0
ID=3300
value=3324
ignorehitpause=1

[State 3300, Bind 1]
type=targetbind
trigger1= numtarget(3300)&&animelemtime(4)=0
pos=ceil(239 * const(size.yScale)), ceil(-92 * const(size.yScale))
ignoreHitPause=1

[State 3310, HitSpark]
type=Helper
triggerall=NumTarget
trigger1 =animelemtime(4)=0
helperType=Normal
stateNo=8015
ID=8000
name="Spark"
posType=P1
pos=ceil(239 * const(size.yScale)), ceil(-92 * const(size.yScale))
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535
ignoreHitPause=1

[State 3310, EnvShake]
type = EnvShake
trigger1 = animelemtime(4)>=0 && animelemtime(5)<=96
trigger1 = timemod = 10,0
time = 10
freq = 100
ampl = 4

[State 3310, HitAdd]
type = HitAdd
triggerall = NumTarget
trigger1=animelemtime(4)=0
value = 1

[State 3310, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget
trigger1=animelemtime(4)=0
value =floor(-85*fvar(10))
kill = 1

[State 3312, Explod]
type = Explod
trigger1 = time = 140
anim =8550
ID = 3350
pos = 0,0
postype = back
facing = 1
vfacing = 1
bindtime = -1
vel = 0,0
accel = 0,0
random = 0,0
removetime =-1
supermovetime = 9999
pausemovetime = 9999
scale = 1.2,1.2
sprpriority = 999
ontop = 0
shadow = 0,0,0
ownpal = 0
removeongethit = 1
ignorehitpause = 1
;persistent =

[State 3312, ModifyExplod]
type = ModifyExplod
trigger1 = time>=140  && time<152
ID = 3350
trans = addalpha
alpha=0+((time-140)*20),256

[State 3312, ModifyExplod]
type = ModifyExplod
trigger1 = time>=153 && time<190
ID = 3350
trans = addalpha
alpha=256,256

[State 3312, ModifyExplod]
type = ModifyExplod
trigger1 = time>=190 && time<202
ID = 3350
trans = addalpha
alpha=256-((time-190)*20),256

[State 3312, RemoveExplod]
type=removeexplod
trigger1= time>=203
ID = 3350

[State 3300, NoShadow]
type=assertspecial
trigger1=AnimElemTime(6)<0
flag=noshadow
ignorehitpause=1

[State 3300, Gravity]
type=Gravity
trigger1=AnimElemTime(6)>0

[State 3200, StateTypeSet: Idle]
type=StateTypeSet
trigger1=AnimElemTime(6) = 0
moveType=I

[State 3300, End]
type=ChangeState
trigger1=AnimElemTime(6)>0&&Pos y>-Vel y
value=3313
;------------------------------------------------------------------
;Mother's Rosario Land
[Statedef 3313]
type=S
movetype=I
physics=N
anim=3313
ctrl=0
velset=0,0
sprpriority=2
facep2=1

[State 3313, PosSet]
type=PosSet
trigger1 =1
y=0
[State 3313, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 3313, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 3300, NotHitBy]
type=NotHitBy
trigger1=1
time=1
value=SCA

[State 3300, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;---------------------------------------------------------------------------
;P2 Fall
[Statedef 3320]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 3320, PosSet]
type = PosSet
trigger1 = !time
x = 72
y = 0
ignorehitpause =1

[State 3320, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
ignorehitpause =1

[State 3301, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause =1

[State 3320, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA
ignorehitpause =1

[State 3320, Anim]
type=changeanim
trigger1= !time&&selfanimexist(5051)
value=5051
[State 3320, Anim]
type=changeanim
trigger1= !time&&!selfanimexist(5051)&&selfanimexist(5050)
value=5050
[State 3320, anim]
type=changeanim2
trigger1= !time&&!selfanimexist(5051)&&!selfanimexist(5050)
value=4020
elem=4
[State 3320, Anim]
type=changeanim
trigger1= vel y > 0 && anim = 5051
value=5050
[State 3320, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = -10

[State 3320, VelAdd]
type = VelAdd
Trigger1 = 1
y = .35

[State 3320, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3320, SelfState]
type = SelfState
trigger1 = Time>0&&Pos Y >= 0&&Vel Y > 0
value = 5100
;---------------------------------------------------------------------------
;P2 Fall
[Statedef 3321]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 3320, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
ignorehitpause =1

[State 3301, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause =1

[State 3320, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA
ignorehitpause =1

[State 3320, Anim]
type=null;changeanim
trigger1= !time&&selfanimexist(5030)
value=5030
[State 3320, anim]
type=null;changeanim2
trigger1= !time&&!selfanimexist(5030)
value=4020
elem=1
[State 3320, anim]
type=changeanim2
trigger1= !time
value=3321
[State 3320, VelSet]
type = VelSet
trigger1 = time = 7
x = 0
y = 4

[State 3320, VelAdd]
type = VelAdd
Trigger1 = time > 7
y = .45

[State 3320, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3320, ChangeState]
type = ChangeState
trigger1 = Pos Y >= -20&&Vel Y > 0
value = 3322
;---------------------------------------------------------------------------
;P2 Bound
[Statedef 3322]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 3320, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
ignorehitpause =1

[State 3301, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause =1

[State 3320, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA
ignorehitpause =1

[State 3320, PosSet]
type = PosSet
trigger1 = !time
y = 0

[State 3320, anim]
type=changeanim2
trigger1= !time
value=4022
[State 3320, VelSet]
type = VelSet
trigger1 = animelem=2
x = 0
y = -6

[State 3320, VelAdd]
type = VelAdd
Trigger1 = animelemtime(2)>0
y = .45

[State 3320, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3320, SelfState]
type = SelfState
trigger1 = Anim = 4022 && AnimElemTime(2) > 0 && Pos Y >= 0&&Vel Y > 0
value = 5100
;---------------------------------------------------------------------------
;P2 Fall
[Statedef 3323]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 3320, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
ignorehitpause =1

[State 3301, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause =1

[State 3320, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA
ignorehitpause =1

[State 3320, Anim]
type=null;changeanim
trigger1= !time&&selfanimexist(5030)
value=5030
[State 3320, anim]
type=null;changeanim2
trigger1= !time&&!selfanimexist(5030)
value=4020
elem=1
[State 3320, anim]
type=changeanim2
trigger1= !time
value=3321
[State 3320, VelSet]
type = VelSet
trigger1 = time = 7
x = 0
y = -2.5

[State 3320, VelAdd]
type = VelAdd
Trigger1 = time > 7
y = .055

[State 3320, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3320, SelfState]
type = SelfState
trigger1 = Pos Y >= -20&&Vel Y > 0
value = 5100
;---------------------------------------------------------------------------
;P2 Fall
[Statedef 3324]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 3320, ScreenBound]
type = ScreenBound
trigger1 = time < 110
value = 0
ignorehitpause =1

[State 3301, PlayerPush]
type = PlayerPush
trigger1 = time < 110
value = 0
ignorehitpause =1

[State 3320, NotHitBy]
type = NotHitBy
trigger1 =time < 110
value = SCA
ignorehitpause =1

[State 3320, anim]
type=changeanim2
trigger1= time<110
value=3321
[State 3320, Anim]
type=changeanim
trigger1= time = 110&&selfanimexist(5050)
value=5050
[State 3320, VelSet]
type = VelSet
trigger1 = time = 110
x = -3
y = 3

[State 3320, VelAdd]
type = VelAdd
Trigger1 = time >= 110
y = .45

[State 3320, NoShadow]
type=assertspecial
trigger1=time<110
flag=noshadow
ignorehitpause=1

[State 3320, SelfState]
type = SelfState
trigger1 = Pos Y >= 0&&Vel Y > 0
value = 5100
;---------------------------------------------------------------------------
;P2 Fall
[Statedef 3325]
type    = A
movetype= H
physics = N
velset = 0,0
sprpriority = 1

[State 3320, PosSet]
type = PosSet
trigger1 = !time
x = -72
y = 0
ignorehitpause =1

[State 3320, ScreenBound]
type = ScreenBound
trigger1 = 1
value = 0
ignorehitpause =1

[State 3301, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause =1

[State 3320, NotHitBy]
type = NotHitBy
trigger1 =1
value = SCA
ignorehitpause =1

[State 3320, Anim]
type=changeanim
trigger1= !time&&selfanimexist(5051)
value=5051
[State 3320, Anim]
type=changeanim
trigger1= !time&&!selfanimexist(5051)&&selfanimexist(5050)
value=5050
[State 3320, anim]
type=changeanim2
trigger1= !time&&!selfanimexist(5051)&&!selfanimexist(5050)
value=4020
elem=4
[State 3320, Anim]
type=changeanim
trigger1= vel y > 0 && anim = 5051
value=5050
[State 3320, VelSet]
type = VelSet
trigger1 = !time
x = 0
y = -10

[State 3320, VelAdd]
type = VelAdd
Trigger1 = 1
y = .35

[State 3320, NoShadow]
type=assertspecial
trigger1=1
flag=noshadow
ignorehitpause=1

[State 3320, SelfState]
type = SelfState
trigger1 = Time>0&&Pos Y >= 0&&Vel Y > 0
value = 5100
;------------------------------------------------------------------
;Absolute Unrivaled Sword
[Statedef 3400]
type=S
movetype=A
physics=N
anim=3400
poweradd=-3000
ctrl=0
velset=0,0
sprpriority=1
facep2=1

[State 3400, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3400, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3400, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3400, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3400, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3400, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3400, SuperPause FX]
type=Helper
trigger1=animelem=1
helperType=Normal
stateNo=8520
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-10 * const(size.xScale)), ceil(-218 * const(size.yScale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3400, SuperPause]
type=SuperPause
trigger1=animelem=1
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,2
darken=0
poweradd=0

[State 3400,BlackBG]
type=helper
trigger1 =animelem=1
helpertype=normal
stateno=3480
ID=3480
name="BlackBG"
postype=Back
supermovetime=99999
pausemovetime=99999
ownpal=1
ignorehitpause=1
size.xScale=5
size.yScale=5

[State 3400, Voice]
type=PlaySnd
trigger1 =!time
value=3400,0
channel=0

[State 3400, NotHitBy]
type=NotHitBy
trigger1=AnimElemTime(6) < 0
time=1
value=SCA

[State 3400, VelSet]
type = VelSet
trigger1 =Animelem =6
x = 12

[State 3400, Dust Helper]
type = Helper
trigger1 = Animelem =6
helperType = Normal
stateNo = 8103
ID = 8100
name = "Dash Dust"
posType = P1
pauseMoveTime = 255
superMoveTime = 255
ownPal = 1

[State 105, Starting Step snd]
type = PlaySnd
trigger1 = AnimElem =6
value = 100, 2

[State 105, Step snd]
type = PlaySnd
trigger1 = AnimElem = 7 || AnimElem = 11 || AnimElem = 15
value = 100,Ifelse((AnimElem = 11),1,0)
channel = 5

[State 3400, No Spark]
type = VarSet
trigger1 =1
var(33)=0
ignorehitpause =1

[State 3400, Hit]
type=HitDef
trigger1 = !time
id=3400
attr=S, HA
damage=0,86
priority=4, hit
animtype=Hard
kill=0
guard.kill=0
numhits=0
getpower=0,0
givepower=20,20
guardflag=MA
hitflag=MAF
hitsound=S2,11
guardsound=S130,0
pausetime=0,1
guard.pausetime=12,12
sparkNo=-1
guard.sparkNo=-1 + 0 * (var(34) :=8001)
sparkXY=-10 + 0 * (var(35) :=40), var(36) :=-48
air.animtype=Back
fall.animtype=Back
ground.type=Low
air.type=Low
ground.slidetime=12
ground.hittime =12
guard.hittime=12
ground.velocity=0
air.velocity=0,0
guard.velocity=-8
airguard.velocity=-8, -2
airguard.ctrlTime=10
ground.cornerPush.velOff=0
guard.cornerPush.velOff=0
air.cornerPush.velOff=0
yaccel=.5
air.fall=1
fall.recover=0
forcestand=1
palFX.time=12 * var(9)
palFX.add=255,255,255
palFX.sinAdd=-255,-255,-255,48
;envshake.time=8
;envshake.ampl=4
;envShake.freq=120

[State 3400, p2state]
type=null;targetstate
trigger1= movehit && numtarget(3400)
trigger1= target(3400),Movetype=H
ID=3400
value=3405
ignorehitpause=1
[State 3400, p1state]
type=changestate
trigger1= movehit && numtarget(3400)
trigger1= target(3400),Movetype=H
value=3410
ignorehitpause=1

[State 3400, End]
type=ChangeState
trigger1=Time>=75|moveguarded
value=3401
;----------------------------------------------------------------------
;Absolute Unrivaled Sword Miss
[Statedef 3401]
type = S
movetype = I
physics = N
ctrl = 0
anim = 3401
poweradd = 0
sprpriority = 1

[State 3400, VelMul]
type = VelMul
trigger1 =1
x = .75

[State 3400, Skid Snd]
type = PlaySnd
trigger1 = AnimElem = 1
value = 101,0
[State 3400, Skid Dust]
type = Explod
trigger1 = AnimElem = 1
anim = 8104
sprPriority=3
posType = P1
pos = -10,3
vel = 0,0
scale = 0.5,0.5
pauseMovetime = -1
superMoveTime = -1
ownpal = 1

[State 3400, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1
;----------------------------------------------------------------------
;Absolute Unrivaled Sword - Success
[Statedef 3410]
type = S
movetype = A
physics = N
ctrl = 0
velset = 0,0
anim = 3410
poweradd = 0
sprpriority = 2

[State 3410, Lv3 Super Afterimage]
type = afterimage
trigger1 = !time
time = 2
timegap = 1
framegap = 10
length = 21
palbright = 0, 0, 0
palcontrast = 160, 32, 32
palpostbright = 0, 0, 0
paladd = 0, 0, 0
palmul = 0.75, 0.75, 0.75
trans = add1

[State 3410, AssertSpecial]
type = AssertSpecial
trigger1 =1
flag = noautoturn

[State 3410, ScreenBound]
type = ScreenBound
trigger1 =1
value = 1
movecamera = 0,1
ignorehitpause =1

[State 3410, PosSet]
type = PosSet
trigger1 = !time
y=0
x=-50*facing

[State 3400, Bind 1]
type = TargetBind
triggerall = NumTarget
trigger1 = !time
pos = 50,0

[State 3410, Facing]
type = Turn
trigger1=animelem=16|animelem=30|animelem=33|animelem=36|animelem=39|animelem=52
trigger2=animelem=73|animelem=75|animelem=77|animelem=79
ignorehitpause =1

[State 3400, VelSet]
type=VelSet
trigger1 =animelem=12
x=14.5
[State 3400, VelMul]
type = VelMul
trigger1 =animelemtime(12)>=0 && animelemtime(28)<0
x = .9

[State 3400, VelSet]
type=VelSet
trigger1 =animelem=28|animelem=31|animelem=34|animelem=37|animelem=40
x=18

[State 3400, VelMul]
type = VelMul
trigger1 =animelemtime(41)>=0 && animelemtime(45)<0
x = .8

[State 3400, VelSet]
type=VelSet
trigger1 =animelem=45
x=-8

[State 3400, VelMul]
type = VelMul
trigger1 =animelemtime(48)>=0 && animelemtime(50)<0
x = .8

[State 3400, VelSet]
type=VelSet
trigger1 =animelem=50
x=20

[State 3400, VelMul]
type = VelMul
trigger1 =animelemtime(52)>=0 && animelemtime(54)<0
x = .8

[State 3400, StateTypeSet]
type=StateTypeSet
trigger1=animelem=54
statetype=A
[State 3400, VelSet]
type=VelSet
trigger1 =animelem=54
x=7
y=-9

[State 3400, VelMul]
type = VelMul
trigger1 =animelemtime(54)>=0&&animelemtime(72)<0
x = .8
y = .8

[State 3400, VelSet]
type=VelSet
trigger1 =animelem=72||animelem=74||animelem=76||animelem=78
x=16-4*(animelem=72)
y=-1.5-2*(animelem=78)

[State 3400, VelMul]
type = VelMul
trigger1 =animelemtime(79)>=0&&animelemtime(82)<0
x = .5
y = .8

[State 3400, VelSet]
type=VelSet
trigger1 =animelem=83
x=0
y=0

[State 3400, VelAdd]
type=VelAdd
trigger1 =animelemtime(86)>=0
y=.55

[State 3400, Up Snd]
type=PlaySnd
trigger1=Animelem=54
value=40,0
[State 3400, Dust Helper]
type=Helper
trigger1=animelem=54
helperType=Normal
stateNo=8100
ID=8100
name="Jump Dust"
posType=P1
ownPal=1

[State 3410, TargetFacing]
type = TargetFacing
trigger1=animelem=3||animelem=8||animelem=14||animelem=19||animelem=24||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40||animelem=45||animelem=47
trigger2=animelem=50||animelem=55||animelem=60||animelem=63||animelem=68
trigger3=animelem=72||animelem=74||animelem=76||animelem=78||animelem=84
value =-1
ID = 3400
ignorehitpause =1

[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=!time
ID=3400
value = 3405
[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=animelem=3||animelem=19||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40
ID=3400
value = 3405
[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=animelem=8||animelem=14||animelem=24||animelem=45||animelem=47
trigger2=animelem=50
ID=3400
value = 3406

[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=animelem=55
ID=3400
value = 3407

[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=animelem=60||animelem=63||animelem=68
ID=3400
value = 3408

[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=animelem=72||animelem=74||animelem=76
ID=3400
value = 3409

[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=animelem=78
ID=3400
value = 3424

[State 3410, TargetState]
type = TargetState
triggerall = NumTarget
trigger1=animelem=84
ID=3400
value = 3425

[State 3400, Voice]
type=PlaySnd
trigger1 =animelem=24
value=3400,1
channel=0
[State 3400, Voice]
type=PlaySnd
trigger1 =animelem=60
value=3400,2
channel=0
[State 3400, Voice]
type=PlaySnd
trigger1 =animelem=83
value=3400,3
channel=0

[State 3400, Helper SLP]
type = Helper
triggerall =anim=3410
trigger1=animelem=3
helpertype = normal
name = "Absolute FX SLP"
ID = 3415
stateno = 300
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper SLK]
type = Helper
triggerall =anim=3410
trigger1=animelem=8
helpertype = normal
name = "Absolute FX SLK"
ID = 3415
stateno = 330
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper Vertical 2]
type = Helper
triggerall =anim=3410
trigger1=animelem=14
helpertype = normal
name = "Absolute FX Vertical 2"
ID = 3415
stateno = 1031
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper CHK]
type = Helper
triggerall =anim=3410
trigger1=animelem=19
helpertype = normal
name = "Absolute FX CMP"
ID = 3415
stateno = 530
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper CMK]
type = Helper
triggerall =anim=3410
trigger1=animelem=24
helpertype = normal
name = "Absolute FX CHK"
ID = 3415
stateno = 550
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper Vertical 4]
type = Helper
triggerall =anim=3410
trigger1=animelem=28|animelem=31|animelem=34|animelem=37|animelem=40
helpertype = normal
name = "Absolute FX Vertical 4"
ID = 3415
stateno = 1033
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper Vertical 3]
type = Helper
triggerall =anim=3410
trigger1=animelem=45
helpertype = normal
name = "Absolute FX Vertical 3"
ID = 3415
stateno = 1032
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper Rush]
type = Helper
triggerall =anim=3410
trigger1=animelem=55
helpertype = normal
name = "Absolute FX Rush"
ID = 3415
stateno = 1215
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper AHP]
type = Helper
triggerall =anim=3410
trigger1=animelem=60
helpertype = normal
name = "Absolute FX AHP"
ID = 3415
stateno = 662
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper ALK]
type = Helper
triggerall =anim=3410
trigger1=animelem=63
helpertype = normal
name = "Absolute FX ALK"
ID = 3415
stateno = 663
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper ALP]
type = Helper
triggerall =anim=3410
trigger1=animelem=68
helpertype = normal
name = "Absolute FX ALP"
ID = 3415
stateno = 660
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper Up]
type = Helper
triggerall =anim=3410
trigger1=animelem=72||animelem=74||animelem=76||animelem=78
helpertype = normal
name = "Absolute FX Up"
ID = 3470
stateno = 3470
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1
[State 3400, Helper Finish]
type = Helper
triggerall =anim=3410
trigger1 = AnimElem = 84
helpertype = normal
name = "Absolute FX Finish"
ID = 3475
stateno = 3475
postype = p1
facing = 1
keyctrl = 0
ownpal = 1
size.xscale=const(size.xscale)
size.yscale=const(size.yscale)
ignorehitpause = 1

[State 3410, Helper]
type = Helper
triggerall = !numhelper(7000)
trigger1 =animelem=83
helpertype = normal ;player
name ="Light"
ID =7000
stateno =7000
pos = 0,0
postype = p1
ownpal = 1
pausemovetime=9999
supermovetime=9999
persistent=1

[State 3400, SND]
type = playsnd
trigger1=animelem=3||animelem=8||animelem=14||animelem=19||animelem=24||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40||animelem=45||animelem=47
trigger2=animelem=50||animelem=55||animelem=60||animelem=63||animelem=68
trigger3=animelem=72||animelem=74||animelem=76||animelem=78||animelem=84
value = 1,ifelse((AnimElem = 84),9,2)
channel=1

[State 3400, SND]
type = playsnd
triggerall = NumTarget
trigger1=animelem=3||animelem=8||animelem=14||animelem=19||animelem=24||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40||animelem=45||animelem=47
trigger2=animelem=50||animelem=55||animelem=60||animelem=63||animelem=68
trigger3=animelem=72||animelem=74||animelem=76||animelem=78||animelem=84
value = ifelse((AnimElem = 84),2+10*var(44),2),ifelse((AnimElem = 84),14,15)
channel=2

[State 3410, EnvShake]
type = EnvShake
triggerall = NumTarget
trigger1=animelem=3||animelem=8||animelem=14||animelem=19||animelem=24||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40||animelem=45||animelem=47
trigger2=animelem=50||animelem=55||animelem=60||animelem=63||animelem=68
trigger3=animelem=72||animelem=74||animelem=76||animelem=78||animelem=84
time = 12
freq = 60
ampl = Ifelse(random<500,5,-5)

[State 3410, HitSpark Standing]
type=Helper
triggerall =numtarget&&anim=3410
trigger1=animelem=3||animelem=8||animelem=14||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40||animelem=45||animelem=47
trigger2=animelem=50
helperType=Normal
stateNo=8015
ID=8000
name="Spark"
posType=P2
pos = ceil(-10*const(size.xscale)),-55
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535

[State 3410, HitSpark Crouching]
type=Helper
triggerall =numtarget&&anim=3410
trigger1=animelem=19||animelem=24
helperType=Normal
stateNo=8015
ID=8000
name="Spark"
posType=P2
pos = ceil(-10*const(size.xscale)),-30
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535

[State 3410, HitSpark Air]
type=Helper
triggerall =numtarget&&anim=3410
trigger1=animelem=55||animelem=60||animelem=63||animelem=68
trigger2=animelem=72||animelem=74||animelem=76||animelem=78||animelem=84
helperType=Normal
stateNo=8015
ID=8000
name="Spark"
posType=P2
pos = ceil(-10*const(size.xscale)),-55
facing=-1
ownPal=1
size.xScale=1
size.yScale=1
pauseMoveTime=65535
superMoveTime=65535

[State 3410, HitAdd]
type = HitAdd
triggerall = NumTarget
trigger1=animelem=3||animelem=8||animelem=14||animelem=19||animelem=24||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40||animelem=45||animelem=47
trigger2=animelem=50||animelem=55||animelem=60||animelem=63||animelem=68
trigger3=animelem=72||animelem=74||animelem=76||animelem=78||animelem=84
value = 1

[State 3410, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget
trigger1=animelem=3||animelem=8||animelem=14||animelem=19||animelem=24||animelem=28||animelem=31||animelem=34||animelem=37||animelem=40||animelem=45||animelem=47
trigger2=animelem=50||animelem=55||animelem=60||animelem=63||animelem=68
trigger3=animelem=72||animelem=74||animelem=76||animelem=78
value =floor(-18*fvar(10))
kill = 0
[State 3410, TargetLifeAdd]
type = TargetLifeAdd
triggerall = NumTarget
trigger1=animelem=84
value =floor(-42*fvar(10))
kill = 1

[State 3410, End]
type = ChangeState
trigger1 = AnimElemTime(86)>0&&Pos y>-Vel y
value = 3411
;------------------------------------------------------------------
; Land
[Statedef 3411]
type=S
movetype=I
physics =S
anim=3411
ctrl=0
velset=0,0

[State 3411, NotHitBy]
type=NotHitBy
trigger1=1
time=1
value=SCA

[State 3411, PosSet]
type=PosSet
trigger1 =1
y=0
[State 3411, Landing Sound]
type=PlaySnd
trigger1=!Time
value=52,0
[State 3411, Landing Dust Explod]
type=Explod
trigger1=!Time
anim=8102
sprPriority=-3
posType=P1
scale=0.5,0.5
pauseMoveTime=-1
superMoveTime=-1
ownPal=1

[State 3411, End]
type=ChangeState
trigger1=!animtime
value=0
ctrl=1
;----------------------------------------------------------------------------------
;Sword Wave
[Statedef 3500]
type    = S
movetype =  A
physics = S
anim = 3500
velset = 0,0
sprpriority = 2
ctrl = 0
poweradd=-1000
juggle = 0


[State 3500, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3500, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3500, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3500, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3500, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3500, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3500, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8500
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-35 * const(size.xScale)), ceil(-307 * const(size.yScale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3500, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,0
darken=0
poweradd=0

[State 3500, NotHitBy]
type=NotHitBy
trigger1=AnimElemTime(3) < 0
time=1
value=SCA

[State 3500, VarSet]
type = VarSet
trigger1 =!time
var(10) = 0
ignorehitpause = 1

[State 3500, VarSet]
type = VarSet
trigger1 =animelem=9
var(10) = 3
ignorehitpause = 1

[State 3500, Voice]
type = PlaySnd
trigger1 = AnimElem = 1
value = 3400,2
channel = 0

[State 3500, Snd]
type = PlaySnd
trigger1 = AnimElem = 3 || AnimElem = 9
value = 1, 7

[State 3500, Projectile]
type = Helper
trigger1 = AnimElem = 3 || AnimElem = 9
helpertype = normal
stateno = 3505
id = 3505
name = "Sword Wave Projectile"
pos=50,-60
postype = P1
size.xscale= .55*const(size.xscale)
size.yscale= .35*const(size.yscale)
ignorehitpause = 1
keyctrl = 0
ownpal = 1

[State 3500, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;----------------------------------------------------------------------------------
;Max Sword Wave
[Statedef 3550]
type    = S
movetype =  A
physics = S
anim = 3550
velset = 0,0
sprpriority = 2
ctrl = 0
poweradd=-2000
juggle = 0


[State 3500, No Corner Push]
type=VarSet
trigger1=!time
fvar(5)=0
[State 3500, Unguardable]
type=VarSet
trigger1=!time && NumEnemy
trigger1=(EnemyNear, StateNo !=[120,155])
var(17)=50
[State 3500, Super Cancel Flag]
type=VarSet
trigger1=!Time
var(21)=(PrevStateNo=[1000,2999]) && var(6)
[State 3500, Hyper Cancel Flag]
type=VarSet
trigger1=!Time
var(22)=(PrevStateNo=[3000,4999]) && var(7)
[State 3500, Super Cancel Flash]
type=PalFX
trigger1=var(21) || var(22)
trigger1=!(Time % 2) && Time <=12
time=1
add=255,255,255
ignoreHitPause=1
[State 3500, Super Cancel Juggle Reset]
type=VarSet
trigger1=!Time
trigger1=var(21) || var(22)
var(15)=0
ignoreHitPause=1

[State 3500, SuperPause FX]
type=Helper
trigger1=!time
helperType=Normal
stateNo=8510
ID=8500
name="Superpause FX"
posType=P1
pos=ceil(-35 * const(size.xScale)), ceil(-307 * const(size.yScale))
superMoveTime=255
size.xScale=1
size.yScale=1
ownPal=1
[State 3500, SuperPause]
type=SuperPause
trigger1=!time
time=50
moveTime=50
p2DefMul=1
unHittable=1
anim=-1
sound=s8500,1
darken=0
poweradd=0

[State 3500, NotHitBy]
type=NotHitBy
trigger1=AnimElemTime(3) < 0
time=1
value=SCA

[State 3500, VarSet]
type = VarSet
trigger1 =!time
var(10) = 0
ignorehitpause = 1

[State 3500, VarSet]
type = VarSet
trigger1 =animelem=9
var(10) = 3
ignorehitpause = 1

[State 3500, Voice]
type = PlaySnd
trigger1 = AnimElem = 1
value = 3300,1
channel = 0

[State 3500, Voice]
type = PlaySnd
trigger1 = AnimElem = 8
value = 1100,3
channel = 0

[State 3500, Snd]
type = PlaySnd
trigger1 = AnimElem = 3 || AnimElem = 5 || AnimElem = 9
value = 1, 7

[State 3500, Projectile]
type = Helper
trigger1 = AnimElem = 3 || AnimElem = 5 || AnimElem = 9
helpertype = normal
stateno = 3505
id = 3505
name = "Sword Wave Projectile"
pos=50,-60
postype = P1
size.xscale= .55*const(size.xscale)
size.yscale= .35*const(size.yscale)
ignorehitpause = 1
keyctrl = 0
ownpal = 1

[State 3500, ChangeState]
type = ChangeState
trigger1 = AnimTime = 0
value = 0
ctrl = 1
;----------------------------------------------------------------------------------
;Raging Swordswoman
[Statedef 3600]
type    = S
movetype= I
physics = N
velset = 0,0
ctrl = 0
anim = 3600
poweradd = -3000
sprpriority = 1
facep2 = 1

[State 3600, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(2) < 0
Time = 1
value = SCA

[State 3600, No Corner Push]
type = VarSet
trigger1 = Time = 3
fvar(5) = 0

[State 3600, Unguardable]
type = VarSet
trigger1 = Time = 3 && NumEnemy
trigger1 = (EnemyNear, StateNo != [120,155])
var(17) = 45

[State 3600, Super Cancel Flag]
type = VarSet
trigger1 = !Time
var(21) = (PrevStateNo = [1000,2999]) && var(6)

[State 3600, Hyper Cancel Flag]
type = VarSet
trigger1 = !Time
var(22) = (PrevStateNo = [3000,4999]) && var(7)

[State 3600, Super Cancel Flash]
type = PalFX
trigger1 = var(21) || var(22)
trigger1 = !(Time % 2) && Time <= 12
Time = 1
add = 255,255,255
ignoreHitPause = 1

[State 3600, Super Cancel Juggle Reset]
type = VarSet
trigger1 = !Time
trigger1 = var(21) || var(22)
var(15) = 0
ignoreHitPause = 1

[State 3600, SuperPause FX]
type = Helper
trigger1 = Time = 0
helperType = Normal
StateNo = 8520
ID = 8520
name = "Superpause FX"
posType = P1
pos = ceil(79*const(size.xscale)),ceil(-131*const(size.yscale))
superMoveTime = 255
size.xScale = 1
size.yScale = 1
ownPal = 1

[State 3600, SuperPause]
type = SuperPause
trigger1 = Time = 0
Time = 50
moveTime = 50
p2DefMul = 1
unHittable = 1
anim = -1
sound = s8500,2
darken = 0
poweradd = 0

[State 3600,BlackBG]
type=helper
trigger1 =animelem=1
helpertype=normal
stateno=3480
ID=3480
name="BlackBG"
postype=Back
supermovetime=99999
pausemovetime=99999
ownpal=1
ignorehitpause=1
size.xScale=5
size.yScale=5

[State 3600, Voice Start]
type = PlaySnd
trigger1 = AnimElem = 1
value = 3600, 0
channel = 0

[State 3600, Reversal]
type=reversaldef
trigger1= !movehit
trigger1= animelemtime(2)>=0 && animelemtime(3)<0
;attr = S,HT
reversal.attr= SCA,NA,SA,HA
pausetime = 0,0
sparkno = -1 + 0 * (var(33) := 0)
sparkxy = 0,0
hitsound = s130,0
p1stateno = 3610
p2stateno = 3615
numhits = 0
id = 3600

[State 3600, End]
type=null;changestate
trigger1= NumTarget
trigger1= Target,StateNo = 3615 && Target,MoveType = H
value=3610

[State 3600, End]
type = ChangeState
trigger1 = !AnimTime 
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Miss
[Statedef 3601]
type = S
movetype = I
physics = N
anim = 3601
velset = 0, 0
poweradd = 0
sprpriority = 1

[State 3601, More Safety]
type = NotHitBy
trigger1 = 1
value = SCA

[State 3601, Spark]
type = helper
trigger1 = !time
helpertype = normal
stateno = 8030
ID = 8000
name = "Spark"
postype = p1
pos = ceil(79*const(size.xscale)),ceil(-131*const(size.yscale))
facing = -1
ownpal = 1
pausemovetime = 65535
supermovetime = 65535
size.xscale = 1.0
size.yscale = 1.0
ignorehitpause = 1

[State 3601, End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1
;---------------------------------------------------------------------------
; Success
[Statedef 3610]
type = S
movetype = A
physics = N
anim = 3610
velset = 0, 0
poweradd = 0
sprpriority = 1

[State 3610, Safety]
type = Null;ChangeState
trigger1 = !Time && !NumTarget
value = 0
ctrl = 1

[State 3610, Miss]
type = ChangeState
triggerall = Time < 16
trigger1 = !NumTarget
trigger2 = NumTarget
trigger2 = Target, IsHelper || Target, StateNo != 3615
value = 3601

[State 3610, More Safety]
type = NotHitBy
trigger1 = 1
value = SCA

[State 3610, TargetState]
type = Null;TargetState
trigger1 = !Time && NumTarget
value = 3615

[State 3610, Spark]
type = helper
trigger1 = !time
helpertype = normal
stateno = 8030
ID = 8000
name = "Spark"
postype = p1
pos = ceil(79*const(size.xscale)),ceil(-131*const(size.yscale))
facing = -1
ownpal = 1
pausemovetime = 65535
supermovetime = 65535
size.xscale = 1.0
size.yscale = 1.0
ignorehitpause = 1

[State 3610, Push]
type = PlayerPush
trigger1 = AnimElemTime(31) >= 0
value = 0
ignorehitpause =1

[State 3610, NotHitBy]
type = NotHitBy
trigger1 = AnimElemTime(31) < 0
value = SCA
Time = 1

[State 3610, Black]
type = null;PalFX
trigger1 = Time = 16
Time = 16
sinadd = -255, -255, -255, 64

[State 3610, Trans]
type = Trans
trigger1 =Time>=16&&Time<32
trans = AddAlpha
alpha = 256-(16*(time-16)),0+(16*(time-16))
ignorehitpause =1

[State 3610, Sprite Priority]
type = SprPriority
trigger1 = AnimElemTime(31) >= 0
value = 1

[State 810, Width]
type = Width
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(31) < 0
edge = 55,0

[State 3610, Bind]
type = TargetBind
trigger1 = AnimElemTime(2) >= 0 && AnimElemTime(31) < 0
pos = 55, 0

[State 3610, HitSpark Position]
type = varrandom
trigger1 = AnimElem = 31, <0
v = 10
range = 0,20

[State 3610, Helper]
type = Helper
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30
helpertype = normal ;player
name ="FX"
ID =3650
stateno =3650
pos = -10+(var(10)),((Target, Const(size.mid.pos.y))-10)+(var(10))
postype = p2
ownpal = 1
persistent=1
size.xScale=.15
size.yScale=.15

[State 3610, Helper]
type = Helper
trigger1 = AnimElem = 31
helpertype = normal ;player
name ="FX"
ID =3651
stateno =3650
pos = ceil(-181 * const(size.xScale)), ceil(-256 * const(size.yScale))
postype = p1
ownpal = 1
persistent=1
size.xScale=.3
size.yScale=.3

[State 3610, Move Sound]
type = Null;PlaySnd
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30
value = 1, 2
channel = 1

[State 3610, Final Move Sound]
type = PlaySnd
trigger1 = AnimElem = 31
value = 1, 11
channel = 1

[State 3610, HitAdd]
type = HitAdd
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30 || AnimElem = 31
value = 1

[State 3610, Damage]
type = TargetLifeAdd
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30 || AnimElem = 31,=-1
value = -14
kill = AnimElem = 31,>=-1

[State 3610, Give Power]
type = TargetPowerAdd
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30 || AnimElem = 31
value = 18

[State 3610, VarAdd]
type = VarAdd
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30 || AnimElem = 31
var(13) = 1

[State 3610, Hit Sound]
type = PlaySnd
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30
value = 2, 15
channel = 2

[State 3610, Final Hit Sound]
type = PlaySnd
trigger1 = AnimElem = 31
value = 2, 17
channel = 2

[State 3610, Voice]
type = null;PlaySnd
trigger1 = AnimElemTime(31) = 0
value = 3400, 3
channel = 0

[State 3610, Hit Spark]
type = Helper
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30
helperType = Normal
StateNo = 8015
ID = 8000
name = "Spark"
posType = P2
pos = -10+(var(10)),((Target, Const(size.mid.pos.y))-10)+(var(10));0, (Target, Const(size.mid.pos.y))
ownPal = 1
pauseMoveTime = 65535
superMoveTime = 65535
size.xscale = 1
size.yscale = 1
sprpriority = 5

[State 3610, Hit Spark]
type = Helper
trigger1 = AnimElem = 31
helperType = Normal
StateNo = 8015
ID = 8000
name = "Spark"
posType = P2
pos = 0, (Target, Const(size.mid.pos.y))
ownPal = 1
pauseMoveTime = 65535
superMoveTime = 65535
size.xscale = 1
size.yscale = 1
sprpriority = 5

[State 3610, Shake]
type = EnvShake
trigger1 = AnimElem = 2, = 1 || AnimElem = 3 || AnimElem = 4 || AnimElem = 5 || AnimElem = 6 || AnimElem = 7 || AnimElem = 8 || AnimElem = 9
trigger2 = AnimElem = 10 || AnimElem = 11 || AnimElem = 12 || AnimElem = 13 || AnimElem = 14 || AnimElem = 15 || AnimElem = 16 || AnimElem = 17 || AnimElem = 18 || AnimElem = 19
trigger3 = AnimElem = 20 || AnimElem = 21 || AnimElem = 22 || AnimElem = 23 || AnimElem = 24 || AnimElem = 25 || AnimElem = 26 || AnimElem = 27 || AnimElem = 28 || AnimElem = 29
trigger4 = AnimElem = 30 || AnimElem = 31
Time = 6
freq = 120
ampl = -4

[State 3610, TargetState]
type = Turn
trigger1 = AnimElemTime(31) = 0

[State 3610, NoMusic]
type = Helper
trigger1 = WinKo
ID = 3690
stateno = 3690
postype = back
pos = 0,0
pausemovetime = 999999
supermovetime = 999999
ignorehitpause = 1
ownpal = 1
persistent=0

[State 3610, TargetState]
type = TargetState
trigger1 = AnimElemTime(31) = 0 && NumTarget
value = 3616

[State 3610, State End]
type = ChangeState
trigger1 = !AnimTime
value = 0
ctrl = 1

; Target 1
[Statedef 3615]
type = A
physics = N
movetype = H
velset = 0, 0
ctrl = 0

[State 3615, IsHelper]
type=destroyself
trigger1=ishelper

[State 3615, NotHitBy]
type = NotHitBy
trigger1 = 1
value = SCA
Time = 1

[State 3615, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause =1

[State 3615, Black]
type = null;PalFX
trigger1 = Time = 16
Time = 16
sinadd = -255, -255, -255, 64

[State 3615, Trans]
type = Trans
trigger1 =Time>=16&&Time<32
trans = AddAlpha
alpha = 256-(16*(time-16)),0+(16*(time-16))
ignorehitpause =1

[State 3615, I'm waaaaaiting]
type = changeanim
trigger1 = time < 32
value = anim
elem = AnimElemNo(0)

[State 3615, NoKO Snd]
type = AssertSpecial
Trigger1 = Time >= 32 && TeamMode != Simul
flag = nokosnd
ignorehitpause =1

[State 3615, Anim]
type = ChangeAnim2
trigger1 = Time = 32
value = 3615

[State 3615, if failed]
type = ChangeState
trigger1 = Time >= 400
value = 3617

;Target 2
[Statedef 3616]
type = L
physics = C
movetype = H
velset = 0, 0
ctrl = 0

[State 3616, More Safety]
type = NotHitBy
trigger1 = 1
value = SCA

[State 3616, PlayerPush]
type = PlayerPush
trigger1 = 1
value = 0
ignorehitpause =1

[State 3616, Anim]
type = ChangeAnim
trigger1 = !Time
value = 5110

[State 3616, Anim]
type = Null;ChangeAnim2
trigger1 = !Time
value = 3616

[State 3616, KO Voice]
type = PlaySnd
trigger1 = !Alive && TeamMode != Simul
value = 11,0
persistent=0

[State 3616, End]
type = SelfState
trigger1 = !Alive
value = 5150

[State 3616, End]
type = SelfState
trigger1 = Time >= 120 && Alive
value = 5120

;Target 3 - if failed
[Statedef 3617]
movetype = H
physics = N
type = A

[State 3617, More Safety]
type = NotHitBy
trigger1 = 1
value = SCA

[State 3617, VelAdd]
type = VelAdd
trigger1 = 1
y = .5

[State 3617, SprPriority]
type = SprPriority
trigger1 = !Time
value = -1

[State 3617, ChangeAnim]
type= ChangeAnim
trigger1 = !Time
value = 5050

[State 3617, CtrlSet]
type = CtrlSet
trigger1 = 1
value = 0

[State 3061, SelfState]
type = SelfState
trigger1= vel y > 0
trigger1= pos y > -vel y
value = 5100